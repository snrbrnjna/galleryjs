/**
 * @license almond 0.2.9 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

//     Underscore.js 1.4.4
//     http://underscorejs.org
//     (c) 2009-2013 Jeremy Ashkenas, DocumentCloud Inc.
//     Underscore may be freely distributed under the MIT license.

//     (c) 2010-2013 Jeremy Ashkenas, DocumentCloud Inc.
//     Backbone may be freely distributed under the MIT license.
//     For all details and documentation:
//     http://backbonejs.org

/*!
 * jQuery UI Effects 1.10.4
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/effects-core/
 */

/*!
 * jQuery Color Animations v2.1.2
 * https://github.com/jquery/jquery-color
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * Date: Wed Jan 16 08:47:09 2013 -0600
 */

/*
 * jQuery throttle / debounce - v1.1 - 3/7/2010
 * http://benalman.com/projects/jquery-throttle-debounce-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */

/**
 * Isotope v1.5.26
 * An exquisite jQuery plugin for magical layouts
 * http://isotope.metafizzy.co
 *
 * Commercial use requires one-time purchase of a commercial license
 * http://isotope.metafizzy.co/docs/license.html
 *
 * Non-commercial use is licensed under the MIT License
 *
 * Copyright 2014 Metafizzy
 */

/*!
   * Modernizr v1.6ish: miniModernizr for Isotope
   * http://www.modernizr.com
   *
   * Developed by:
   * - Faruk Ates  http://farukat.es/
   * - Paul Irish  http://paulirish.com/
   *
   * Copyright (c) 2009-2010
   * Dual-licensed under the BSD or MIT licenses.
   * http://www.modernizr.com/license/
   */

/*
   * smartresize: debounced resize event for jQuery
   *
   * latest version and complete README available on Github:
   * https://github.com/louisremi/jquery.smartresize.js
   *
   * Copyright 2011 @louis_remi
   * Licensed under the MIT license.
   */

/*!
   * jQuery imagesLoaded plugin v1.1.0
   * http://github.com/desandro/imagesloaded
   *
   * MIT License. by Paul Irish et al.
   */

/*!
 * EventEmitter v4.2.7 - git.io/ee
 * Oliver Caldwell
 * MIT license
 * @preserve
 */

/*!
 * eventie v1.0.5
 * event binding helper
 *   eventie.bind( elem, 'click', myFn )
 *   eventie.unbind( elem, 'click', myFn )
 * MIT license
 */

/*!
 * imagesLoaded v3.1.4
 * JavaScript is all like "You images are done yet or what?"
 * MIT License
 */

/*
* @fileOverview TouchSwipe - jQuery Plugin
* @version 1.6.3
*
* @author Matt Bryson http://www.github.com/mattbryson
* @see https://github.com/mattbryson/TouchSwipe-Jquery-Plugin
* @see http://labs.skinkers.com/touchSwipe/
* @see http://plugins.jquery.com/project/touchSwipe
*
* Copyright (c) 2010 Matt Bryson
* Dual licensed under the MIT or GPL Version 2 licenses.
*
*
* Changelog
* $Date: 2010-12-12 (Wed, 12 Dec 2010) $
* $version: 1.0.0
* $version: 1.0.1 - removed multibyte comments
*
* $Date: 2011-21-02 (Mon, 21 Feb 2011) $
* $version: 1.1.0 	- added allowPageScroll property to allow swiping and scrolling of page
*					- changed handler signatures so one handler can be used for multiple events
* $Date: 2011-23-02 (Wed, 23 Feb 2011) $
* $version: 1.2.0 	- added click handler. This is fired if the user simply clicks and does not swipe. The event object and click target are passed to handler.
*					- If you use the http://code.google.com/p/jquery-ui-for-ipad-and-iphone/ plugin, you can also assign jQuery mouse events to children of a touchSwipe object.
* $version: 1.2.1 	- removed console log!
*
* $version: 1.2.2 	- Fixed bug where scope was not preserved in callback methods.
*
* $Date: 2011-28-04 (Thurs, 28 April 2011) $
* $version: 1.2.4 	- Changed licence terms to be MIT or GPL inline with jQuery. Added check for support of touch events to stop non compatible browsers erroring.
*
* $Date: 2011-27-09 (Tues, 27 September 2011) $
* $version: 1.2.5 	- Added support for testing swipes with mouse on desktop browser (thanks to https://github.com/joelhy)
*
* $Date: 2012-14-05 (Mon, 14 May 2012) $
* $version: 1.2.6 	- Added timeThreshold between start and end touch, so user can ignore slow swipes (thanks to Mark Chase). Default is null, all swipes are detected
*
* $Date: 2012-05-06 (Tues, 05 June 2012) $
* $version: 1.2.7 	- Changed time threshold to have null default for backwards compatibility. Added duration param passed back in events, and refactored how time is handled.
*
* $Date: 2012-05-06 (Tues, 05 June 2012) $
* $version: 1.2.8 	- Added the possibility to return a value like null or false in the trigger callback. In that way we can control when the touch start/move should take effect or not (simply by returning in some cases return null; or return false;) This effects the ontouchstart/ontouchmove event.
*
* $Date: 2012-06-06 (Wed, 06 June 2012) $
* $version: 1.3.0 	- Refactored whole plugin to allow for methods to be executed, as well as exposed defaults for user override. Added 'enable', 'disable', and 'destroy' methods
*
* $Date: 2012-05-06 (Fri, 05 June 2012) $
* $version: 1.3.1 	- Bug fixes  - bind() with false as last argument is no longer supported in jQuery 1.6, also, if you just click, the duration is now returned correctly.
*
* $Date: 2012-29-07 (Sun, 29 July 2012) $
* $version: 1.3.2	- Added fallbackToMouseEvents option to NOT capture mouse events on non touch devices.
* 			- Added "all" fingers value to the fingers property, so any combinatin of fingers triggers the swipe, allowing event handlers to check the finger count
*
* $Date: 2012-09-08 (Thurs, 9 Aug 2012) $
* $version: 1.3.3	- Code tidy prep for minified version
*
* $Date: 2012-04-10 (wed, 4 Oct 2012) $
* $version: 1.4.0	- Added pinch support, pinchIn and pinchOut
*
* $Date: 2012-11-10 (Thurs, 11 Oct 2012) $
* $version: 1.5.0	- Added excludedElements, a jquery selector that specifies child elements that do NOT trigger swipes. By default, this is one select that removes all form, input select, button and anchor elements.
*
* $Date: 2012-22-10 (Mon, 22 Oct 2012) $
* $version: 1.5.1	- Fixed bug with jQuery 1.8 and trailing comma in excludedElements
*					- Fixed bug with IE and eventPreventDefault()
* $Date: 2013-01-12 (Fri, 12 Jan 2013) $
* $version: 1.6.0	- Fixed bugs with pinching, mainly when both pinch and swipe enabled, as well as adding time threshold for multifinger gestures, so releasing one finger beofre the other doesnt trigger as single finger gesture.
*					- made the demo site all static local HTML pages so they can be run locally by a developer
*					- added jsDoc comments and added documentation for the plugin	
*					- code tidy
*					- added triggerOnTouchLeave property that will end the event when the user swipes off the element.
* $Date: 2013-03-23 (Sat, 23 Mar 2013) $
* $version: 1.6.1	- Added support for ie8 touch events
* $version: 1.6.2	- Added support for events binding with on / off / bind in jQ for all callback names.
*                   - Deprecated the 'click' handler in favour of tap.
*                   - added cancelThreshold property
*                   - added option method to update init options at runtime
*
* $version 1.6.3    - added doubletap, longtap events and longTapThreshold, doubleTapThreshold property
* $Date: 2013-04-04 (Thurs, 04 April 2013) $
* $version 1.6.4    - Fixed bug with cancelThreshold introduced in 1.6.3, where swipe status no longer fired start event, and stopped once swiping back.
*/

!function(t,e){"function"==typeof define&&define.amd?define([],e):t.GalleryApp=e()}(this,function(){var t,e,n;return function(i){function r(t,e){return b.call(t,e)}function s(t,e){var n,i,r,s,o,a,u,l,h,c,f,d=e&&e.split("/"),p=y.map,g=p&&p["*"]||{};if(t&&"."===t.charAt(0))if(e){for(d=d.slice(0,d.length-1),t=t.split("/"),o=t.length-1,y.nodeIdCompat&&x.test(t[o])&&(t[o]=t[o].replace(x,"")),t=d.concat(t),h=0;h<t.length;h+=1)if(f=t[h],"."===f)t.splice(h,1),h-=1;else if(".."===f){if(1===h&&(".."===t[2]||".."===t[0]))break;h>0&&(t.splice(h-1,2),h-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((d||g)&&p){for(n=t.split("/"),h=n.length;h>0;h-=1){if(i=n.slice(0,h).join("/"),d)for(c=d.length;c>0;c-=1)if(r=p[d.slice(0,c).join("/")],r&&(r=r[i])){s=r,a=h;break}if(s)break;!u&&g&&g[i]&&(u=g[i],l=h)}!s&&u&&(s=u,a=l),s&&(n.splice(0,a,s),t=n.join("/"))}return t}function o(t,e){return function(){return d.apply(i,_.call(arguments,0).concat([t,e]))}}function a(t){return function(e){return s(e,t)}}function u(t){return function(e){m[t]=e}}function l(t){if(r(v,t)){var e=v[t];delete v[t],w[t]=!0,f.apply(i,e)}if(!r(m,t)&&!r(w,t))throw new Error("No "+t);return m[t]}function h(t){var e,n=t?t.indexOf("!"):-1;return n>-1&&(e=t.substring(0,n),t=t.substring(n+1,t.length)),[e,t]}function c(t){return function(){return y&&y.config&&y.config[t]||{}}}var f,d,p,g,m={},v={},y={},w={},b=Object.prototype.hasOwnProperty,_=[].slice,x=/\.js$/;p=function(t,e){var n,i=h(t),r=i[0];return t=i[1],r&&(r=s(r,e),n=l(r)),r?t=n&&n.normalize?n.normalize(t,a(e)):s(t,e):(t=s(t,e),i=h(t),r=i[0],t=i[1],r&&(n=l(r))),{f:r?r+"!"+t:t,n:t,pr:r,p:n}},g={require:function(t){return o(t)},exports:function(t){var e=m[t];return"undefined"!=typeof e?e:m[t]={}},module:function(t){return{id:t,uri:"",exports:m[t],config:c(t)}}},f=function(t,e,n,s){var a,h,c,f,d,y,b=[],_=typeof n;if(s=s||t,"undefined"===_||"function"===_){for(e=!e.length&&n.length?["require","exports","module"]:e,d=0;d<e.length;d+=1)if(f=p(e[d],s),h=f.f,"require"===h)b[d]=g.require(t);else if("exports"===h)b[d]=g.exports(t),y=!0;else if("module"===h)a=b[d]=g.module(t);else if(r(m,h)||r(v,h)||r(w,h))b[d]=l(h);else{if(!f.p)throw new Error(t+" missing "+h);f.p.load(f.n,o(s,!0),u(h),{}),b[d]=m[h]}c=n?n.apply(m[t],b):void 0,t&&(a&&a.exports!==i&&a.exports!==m[t]?m[t]=a.exports:c===i&&y||(m[t]=c))}else t&&(m[t]=n)},t=e=d=function(t,e,n,r,s){if("string"==typeof t)return g[t]?g[t](e):l(p(t,e).f);if(!t.splice){if(y=t,y.deps&&d(y.deps,y.callback),!e)return;e.splice?(t=e,e=n,n=null):t=i}return e=e||function(){},"function"==typeof n&&(n=r,r=s),r?f(i,t,e,n):setTimeout(function(){f(i,t,e,n)},4),d},d.config=function(t){return d(t)},t._defined=m,n=function(t,e,n){e.splice||(n=e,e=[]),r(m,t)||r(v,t)||(v[t]=[t,e,n])},n.amd={jQuery:!0}}(),n("almond",function(){}),function(){var t=this,e=t._,n={},i=Array.prototype,r=Object.prototype,s=Function.prototype,o=i.push,a=i.slice,u=i.concat,l=r.toString,h=r.hasOwnProperty,c=i.forEach,f=i.map,d=i.reduce,p=i.reduceRight,g=i.filter,m=i.every,v=i.some,y=i.indexOf,w=i.lastIndexOf,b=Array.isArray,_=Object.keys,x=s.bind,C=function(t){return t instanceof C?t:this instanceof C?void(this._wrapped=t):new C(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=C),exports._=C):t._=C,C.VERSION="1.4.4";var T=C.each=C.forEach=function(t,e,i){if(null!=t)if(c&&t.forEach===c)t.forEach(e,i);else if(t.length===+t.length){for(var r=0,s=t.length;s>r;r++)if(e.call(i,t[r],r,t)===n)return}else for(var o in t)if(C.has(t,o)&&e.call(i,t[o],o,t)===n)return};C.map=C.collect=function(t,e,n){var i=[];return null==t?i:f&&t.map===f?t.map(e,n):(T(t,function(t,r,s){i[i.length]=e.call(n,t,r,s)}),i)};var S="Reduce of empty array with no initial value";C.reduce=C.foldl=C.inject=function(t,e,n,i){var r=arguments.length>2;if(null==t&&(t=[]),d&&t.reduce===d)return i&&(e=C.bind(e,i)),r?t.reduce(e,n):t.reduce(e);if(T(t,function(t,s,o){r?n=e.call(i,n,t,s,o):(n=t,r=!0)}),!r)throw new TypeError(S);return n},C.reduceRight=C.foldr=function(t,e,n,i){var r=arguments.length>2;if(null==t&&(t=[]),p&&t.reduceRight===p)return i&&(e=C.bind(e,i)),r?t.reduceRight(e,n):t.reduceRight(e);var s=t.length;if(s!==+s){var o=C.keys(t);s=o.length}if(T(t,function(a,u,l){u=o?o[--s]:--s,r?n=e.call(i,n,t[u],u,l):(n=t[u],r=!0)}),!r)throw new TypeError(S);return n},C.find=C.detect=function(t,e,n){var i;return k(t,function(t,r,s){return e.call(n,t,r,s)?(i=t,!0):void 0}),i},C.filter=C.select=function(t,e,n){var i=[];return null==t?i:g&&t.filter===g?t.filter(e,n):(T(t,function(t,r,s){e.call(n,t,r,s)&&(i[i.length]=t)}),i)},C.reject=function(t,e,n){return C.filter(t,function(t,i,r){return!e.call(n,t,i,r)},n)},C.every=C.all=function(t,e,i){e||(e=C.identity);var r=!0;return null==t?r:m&&t.every===m?t.every(e,i):(T(t,function(t,s,o){return(r=r&&e.call(i,t,s,o))?void 0:n}),!!r)};var k=C.some=C.any=function(t,e,i){e||(e=C.identity);var r=!1;return null==t?r:v&&t.some===v?t.some(e,i):(T(t,function(t,s,o){return r||(r=e.call(i,t,s,o))?n:void 0}),!!r)};C.contains=C.include=function(t,e){return null==t?!1:y&&t.indexOf===y?-1!=t.indexOf(e):k(t,function(t){return t===e})},C.invoke=function(t,e){var n=a.call(arguments,2),i=C.isFunction(e);return C.map(t,function(t){return(i?e:t[e]).apply(t,n)})},C.pluck=function(t,e){return C.map(t,function(t){return t[e]})},C.where=function(t,e,n){return C.isEmpty(e)?n?null:[]:C[n?"find":"filter"](t,function(t){for(var n in e)if(e[n]!==t[n])return!1;return!0})},C.findWhere=function(t,e){return C.where(t,e,!0)},C.max=function(t,e,n){if(!e&&C.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!e&&C.isEmpty(t))return-1/0;var i={computed:-1/0,value:-1/0};return T(t,function(t,r,s){var o=e?e.call(n,t,r,s):t;o>=i.computed&&(i={value:t,computed:o})}),i.value},C.min=function(t,e,n){if(!e&&C.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!e&&C.isEmpty(t))return 1/0;var i={computed:1/0,value:1/0};return T(t,function(t,r,s){var o=e?e.call(n,t,r,s):t;o<i.computed&&(i={value:t,computed:o})}),i.value},C.shuffle=function(t){var e,n=0,i=[];return T(t,function(t){e=C.random(n++),i[n-1]=i[e],i[e]=t}),i};var A=function(t){return C.isFunction(t)?t:function(e){return e[t]}};C.sortBy=function(t,e,n){var i=A(e);return C.pluck(C.map(t,function(t,e,r){return{value:t,index:e,criteria:i.call(n,t,e,r)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return t.index<e.index?-1:1}),"value")};var E=function(t,e,n,i){var r={},s=A(e||C.identity);return T(t,function(e,o){var a=s.call(n,e,o,t);i(r,a,e)}),r};C.groupBy=function(t,e,n){return E(t,e,n,function(t,e,n){(C.has(t,e)?t[e]:t[e]=[]).push(n)})},C.countBy=function(t,e,n){return E(t,e,n,function(t,e){C.has(t,e)||(t[e]=0),t[e]++})},C.sortedIndex=function(t,e,n,i){n=null==n?C.identity:A(n);for(var r=n.call(i,e),s=0,o=t.length;o>s;){var a=s+o>>>1;n.call(i,t[a])<r?s=a+1:o=a}return s},C.toArray=function(t){return t?C.isArray(t)?a.call(t):t.length===+t.length?C.map(t,C.identity):C.values(t):[]},C.size=function(t){return null==t?0:t.length===+t.length?t.length:C.keys(t).length},C.first=C.head=C.take=function(t,e,n){return null==t?void 0:null==e||n?t[0]:a.call(t,0,e)},C.initial=function(t,e,n){return a.call(t,0,t.length-(null==e||n?1:e))},C.last=function(t,e,n){return null==t?void 0:null==e||n?t[t.length-1]:a.call(t,Math.max(t.length-e,0))},C.rest=C.tail=C.drop=function(t,e,n){return a.call(t,null==e||n?1:e)},C.compact=function(t){return C.filter(t,C.identity)};var M=function(t,e,n){return T(t,function(t){C.isArray(t)?e?o.apply(n,t):M(t,e,n):n.push(t)}),n};C.flatten=function(t,e){return M(t,e,[])},C.without=function(t){return C.difference(t,a.call(arguments,1))},C.uniq=C.unique=function(t,e,n,i){C.isFunction(e)&&(i=n,n=e,e=!1);var r=n?C.map(t,n,i):t,s=[],o=[];return T(r,function(n,i){(e?i&&o[o.length-1]===n:C.contains(o,n))||(o.push(n),s.push(t[i]))}),s},C.union=function(){return C.uniq(u.apply(i,arguments))},C.intersection=function(t){var e=a.call(arguments,1);return C.filter(C.uniq(t),function(t){return C.every(e,function(e){return C.indexOf(e,t)>=0})})},C.difference=function(t){var e=u.apply(i,a.call(arguments,1));return C.filter(t,function(t){return!C.contains(e,t)})},C.zip=function(){for(var t=a.call(arguments),e=C.max(C.pluck(t,"length")),n=new Array(e),i=0;e>i;i++)n[i]=C.pluck(t,""+i);return n},C.object=function(t,e){if(null==t)return{};for(var n={},i=0,r=t.length;r>i;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n},C.indexOf=function(t,e,n){if(null==t)return-1;var i=0,r=t.length;if(n){if("number"!=typeof n)return i=C.sortedIndex(t,e),t[i]===e?i:-1;i=0>n?Math.max(0,r+n):n}if(y&&t.indexOf===y)return t.indexOf(e,n);for(;r>i;i++)if(t[i]===e)return i;return-1},C.lastIndexOf=function(t,e,n){if(null==t)return-1;var i=null!=n;if(w&&t.lastIndexOf===w)return i?t.lastIndexOf(e,n):t.lastIndexOf(e);for(var r=i?n:t.length;r--;)if(t[r]===e)return r;return-1},C.range=function(t,e,n){arguments.length<=1&&(e=t||0,t=0),n=arguments[2]||1;for(var i=Math.max(Math.ceil((e-t)/n),0),r=0,s=new Array(i);i>r;)s[r++]=t,t+=n;return s},C.bind=function(t,e){if(t.bind===x&&x)return x.apply(t,a.call(arguments,1));var n=a.call(arguments,2);return function(){return t.apply(e,n.concat(a.call(arguments)))}},C.partial=function(t){var e=a.call(arguments,1);return function(){return t.apply(this,e.concat(a.call(arguments)))}},C.bindAll=function(t){var e=a.call(arguments,1);return 0===e.length&&(e=C.functions(t)),T(e,function(e){t[e]=C.bind(t[e],t)}),t},C.memoize=function(t,e){var n={};return e||(e=C.identity),function(){var i=e.apply(this,arguments);return C.has(n,i)?n[i]:n[i]=t.apply(this,arguments)}},C.delay=function(t,e){var n=a.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},C.defer=function(t){return C.delay.apply(C,[t,1].concat(a.call(arguments,1)))},C.throttle=function(t,e){var n,i,r,s,o=0,a=function(){o=new Date,r=null,s=t.apply(n,i)};return function(){var u=new Date,l=e-(u-o);return n=this,i=arguments,0>=l?(clearTimeout(r),r=null,o=u,s=t.apply(n,i)):r||(r=setTimeout(a,l)),s}},C.debounce=function(t,e,n){var i,r;return function(){var s=this,o=arguments,a=function(){i=null,n||(r=t.apply(s,o))},u=n&&!i;return clearTimeout(i),i=setTimeout(a,e),u&&(r=t.apply(s,o)),r}},C.once=function(t){var e,n=!1;return function(){return n?e:(n=!0,e=t.apply(this,arguments),t=null,e)}},C.wrap=function(t,e){return function(){var n=[t];return o.apply(n,arguments),e.apply(this,n)}},C.compose=function(){var t=arguments;return function(){for(var e=arguments,n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},C.after=function(t,e){return 0>=t?e():function(){return--t<1?e.apply(this,arguments):void 0}},C.keys=_||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var n in t)C.has(t,n)&&(e[e.length]=n);return e},C.values=function(t){var e=[];for(var n in t)C.has(t,n)&&e.push(t[n]);return e},C.pairs=function(t){var e=[];for(var n in t)C.has(t,n)&&e.push([n,t[n]]);return e},C.invert=function(t){var e={};for(var n in t)C.has(t,n)&&(e[t[n]]=n);return e},C.functions=C.methods=function(t){var e=[];for(var n in t)C.isFunction(t[n])&&e.push(n);return e.sort()},C.extend=function(t){return T(a.call(arguments,1),function(e){if(e)for(var n in e)t[n]=e[n]}),t},C.pick=function(t){var e={},n=u.apply(i,a.call(arguments,1));return T(n,function(n){n in t&&(e[n]=t[n])}),e},C.omit=function(t){var e={},n=u.apply(i,a.call(arguments,1));for(var r in t)C.contains(n,r)||(e[r]=t[r]);return e},C.defaults=function(t){return T(a.call(arguments,1),function(e){if(e)for(var n in e)null==t[n]&&(t[n]=e[n])}),t},C.clone=function(t){return C.isObject(t)?C.isArray(t)?t.slice():C.extend({},t):t},C.tap=function(t,e){return e(t),t};var j=function(t,e,n,i){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof C&&(t=t._wrapped),e instanceof C&&(e=e._wrapped);var r=l.call(t);if(r!=l.call(e))return!1;switch(r){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var s=n.length;s--;)if(n[s]==t)return i[s]==e;n.push(t),i.push(e);var o=0,a=!0;if("[object Array]"==r){if(o=t.length,a=o==e.length)for(;o--&&(a=j(t[o],e[o],n,i)););}else{var u=t.constructor,h=e.constructor;if(u!==h&&!(C.isFunction(u)&&u instanceof u&&C.isFunction(h)&&h instanceof h))return!1;for(var c in t)if(C.has(t,c)&&(o++,!(a=C.has(e,c)&&j(t[c],e[c],n,i))))break;if(a){for(c in e)if(C.has(e,c)&&!o--)break;a=!o}}return n.pop(),i.pop(),a};C.isEqual=function(t,e){return j(t,e,[],[])},C.isEmpty=function(t){if(null==t)return!0;if(C.isArray(t)||C.isString(t))return 0===t.length;for(var e in t)if(C.has(t,e))return!1;return!0},C.isElement=function(t){return!(!t||1!==t.nodeType)},C.isArray=b||function(t){return"[object Array]"==l.call(t)},C.isObject=function(t){return t===Object(t)},T(["Arguments","Function","String","Number","Date","RegExp"],function(t){C["is"+t]=function(e){return l.call(e)=="[object "+t+"]"}}),C.isArguments(arguments)||(C.isArguments=function(t){return!(!t||!C.has(t,"callee"))}),"function"!=typeof/./&&(C.isFunction=function(t){return"function"==typeof t}),C.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},C.isNaN=function(t){return C.isNumber(t)&&t!=+t},C.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==l.call(t)},C.isNull=function(t){return null===t},C.isUndefined=function(t){return void 0===t},C.has=function(t,e){return h.call(t,e)},C.noConflict=function(){return t._=e,this},C.identity=function(t){return t},C.times=function(t,e,n){for(var i=Array(t),r=0;t>r;r++)i[r]=e.call(n,r);return i},C.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))};var O={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};O.unescape=C.invert(O.escape);var L={escape:new RegExp("["+C.keys(O.escape).join("")+"]","g"),unescape:new RegExp("("+C.keys(O.unescape).join("|")+")","g")};C.each(["escape","unescape"],function(t){C[t]=function(e){return null==e?"":(""+e).replace(L[t],function(e){return O[t][e]})}}),C.result=function(t,e){if(null==t)return null;var n=t[e];return C.isFunction(n)?n.call(t):n},C.mixin=function(t){T(C.functions(t),function(e){var n=C[e]=t[e];C.prototype[e]=function(){var t=[this._wrapped];return o.apply(t,arguments),R.call(this,n.apply(C,t))}})};var z=0;C.uniqueId=function(t){var e=++z+"";return t?t+e:e},C.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var I=/(.)^/,$={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},P=/\\|'|\r|\n|\t|\u2028|\u2029/g;C.template=function(t,e,n){var i;n=C.defaults({},n,C.templateSettings);var r=new RegExp([(n.escape||I).source,(n.interpolate||I).source,(n.evaluate||I).source].join("|")+"|$","g"),s=0,o="__p+='";t.replace(r,function(e,n,i,r,a){return o+=t.slice(s,a).replace(P,function(t){return"\\"+$[t]}),n&&(o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),i&&(o+="'+\n((__t=("+i+"))==null?'':__t)+\n'"),r&&(o+="';\n"+r+"\n__p+='"),s=a+e.length,e}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{i=new Function(n.variable||"obj","_",o)}catch(a){throw a.source=o,a}if(e)return i(e,C);var u=function(t){return i.call(this,t,C)};return u.source="function("+(n.variable||"obj")+"){\n"+o+"}",u},C.chain=function(t){return C(t).chain()};var R=function(t){return this._chain?C(t).chain():t};C.mixin(C),T(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=i[t];C.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!=t&&"splice"!=t||0!==n.length||delete n[0],R.call(this,n)}}),T(["concat","join","slice"],function(t){var e=i[t];C.prototype[t]=function(){return R.call(this,e.apply(this._wrapped,arguments))}}),C.extend(C.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),n("underscore",function(t){return function(){var e;return e||t._}}(this)),function(){var t,n=this,i=n.Backbone,r=[],s=r.push,o=r.slice,a=r.splice;t="undefined"!=typeof exports?exports:n.Backbone={},t.VERSION="1.0.0";var u=n._;u||"undefined"==typeof e||(u=e("underscore")),t.$=n.jQuery||n.Zepto||n.ender||n.$,t.noConflict=function(){return n.Backbone=i,this},t.emulateHTTP=!1,t.emulateJSON=!1;var l=t.Events={on:function(t,e,n){if(!c(this,"on",t,[e,n])||!e)return this;this._events||(this._events={});var i=this._events[t]||(this._events[t]=[]);return i.push({callback:e,context:n,ctx:n||this}),this},once:function(t,e,n){if(!c(this,"once",t,[e,n])||!e)return this;var i=this,r=u.once(function(){i.off(t,r),e.apply(this,arguments)});return r._callback=e,this.on(t,r,n)},off:function(t,e,n){var i,r,s,o,a,l,h,f;if(!this._events||!c(this,"off",t,[e,n]))return this;if(!t&&!e&&!n)return this._events={},this;for(o=t?[t]:u.keys(this._events),a=0,l=o.length;l>a;a++)if(t=o[a],s=this._events[t]){if(this._events[t]=i=[],e||n)for(h=0,f=s.length;f>h;h++)r=s[h],(e&&e!==r.callback&&e!==r.callback._callback||n&&n!==r.context)&&i.push(r);i.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=o.call(arguments,1);if(!c(this,"trigger",t,e))return this;var n=this._events[t],i=this._events.all;return n&&f(n,e),i&&f(i,arguments),this},stopListening:function(t,e,n){var i=this._listeners;if(!i)return this;var r=!e&&!n;"object"==typeof e&&(n=this),t&&((i={})[t._listenerId]=t);for(var s in i)i[s].off(e,n,this),r&&delete this._listeners[s];return this}},h=/\s+/,c=function(t,e,n,i){if(!n)return!0;if("object"==typeof n){for(var r in n)t[e].apply(t,[r,n[r]].concat(i));return!1}if(h.test(n)){for(var s=n.split(h),o=0,a=s.length;a>o;o++)t[e].apply(t,[s[o]].concat(i));return!1}return!0},f=function(t,e){var n,i=-1,r=t.length,s=e[0],o=e[1],a=e[2];switch(e.length){case 0:for(;++i<r;)(n=t[i]).callback.call(n.ctx);return;case 1:for(;++i<r;)(n=t[i]).callback.call(n.ctx,s);return;case 2:for(;++i<r;)(n=t[i]).callback.call(n.ctx,s,o);return;case 3:for(;++i<r;)(n=t[i]).callback.call(n.ctx,s,o,a);return;default:for(;++i<r;)(n=t[i]).callback.apply(n.ctx,e)}},d={listenTo:"on",listenToOnce:"once"};u.each(d,function(t,e){l[e]=function(e,n,i){var r=this._listeners||(this._listeners={}),s=e._listenerId||(e._listenerId=u.uniqueId("l"));return r[s]=e,"object"==typeof n&&(i=this),e[t](n,i,this),this}}),l.bind=l.on,l.unbind=l.off,u.extend(t,l);var p=t.Model=function(t,e){var n,i=t||{};e||(e={}),this.cid=u.uniqueId("c"),this.attributes={},u.extend(this,u.pick(e,g)),e.parse&&(i=this.parse(i,e)||{}),(n=u.result(this,"defaults"))&&(i=u.defaults({},i,n)),this.set(i,e),this.changed={},this.initialize.apply(this,arguments)},g=["url","urlRoot","collection"];u.extend(p.prototype,l,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return u.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return u.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,n){var i,r,s,o,a,l,h,c;if(null==t)return this;if("object"==typeof t?(r=t,n=e):(r={})[t]=e,n||(n={}),!this._validate(r,n))return!1;s=n.unset,a=n.silent,o=[],l=this._changing,this._changing=!0,l||(this._previousAttributes=u.clone(this.attributes),this.changed={}),c=this.attributes,h=this._previousAttributes,this.idAttribute in r&&(this.id=r[this.idAttribute]);for(i in r)e=r[i],u.isEqual(c[i],e)||o.push(i),u.isEqual(h[i],e)?delete this.changed[i]:this.changed[i]=e,s?delete c[i]:c[i]=e;if(!a){o.length&&(this._pending=!0);for(var f=0,d=o.length;d>f;f++)this.trigger("change:"+o[f],this,c[o[f]],n)}if(l)return this;if(!a)for(;this._pending;)this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,u.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var n in this.attributes)e[n]=void 0;return this.set(e,u.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!u.isEmpty(this.changed):u.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?u.clone(this.changed):!1;var e,n=!1,i=this._changing?this._previousAttributes:this.attributes;for(var r in t)u.isEqual(i[r],e=t[r])||((n||(n={}))[r]=e);return n},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return u.clone(this._previousAttributes)},fetch:function(t){t=t?u.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=this,n=t.success;return t.success=function(i){return e.set(e.parse(i,t),t)?(n&&n(e,i,t),void e.trigger("sync",e,i,t)):!1},H(this,t),this.sync("read",this,t)},save:function(t,e,n){var i,r,s,o=this.attributes;if(null==t||"object"==typeof t?(i=t,n=e):(i={})[t]=e,!(!i||n&&n.wait||this.set(i,n)))return!1;if(n=u.extend({validate:!0},n),!this._validate(i,n))return!1;i&&n.wait&&(this.attributes=u.extend({},o,i)),void 0===n.parse&&(n.parse=!0);var a=this,l=n.success;return n.success=function(t){a.attributes=o;var e=a.parse(t,n);return n.wait&&(e=u.extend(i||{},e)),u.isObject(e)&&!a.set(e,n)?!1:(l&&l(a,t,n),void a.trigger("sync",a,t,n))},H(this,n),r=this.isNew()?"create":n.patch?"patch":"update","patch"===r&&(n.attrs=i),s=this.sync(r,this,n),i&&n.wait&&(this.attributes=o),s},destroy:function(t){t=t?u.clone(t):{};var e=this,n=t.success,i=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(r){(t.wait||e.isNew())&&i(),n&&n(e,r,t),e.isNew()||e.trigger("sync",e,r,t)},this.isNew())return t.success(),!1;H(this,t);var r=this.sync("delete",this,t);return t.wait||i(),r},url:function(){var t=u.result(this,"urlRoot")||u.result(this.collection,"url")||R();return this.isNew()?t:t+("/"===t.charAt(t.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(t){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(t){return this._validate({},u.extend(t||{},{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=u.extend({},this.attributes,t);var n=this.validationError=this.validate(t,e)||null;return n?(this.trigger("invalid",this,n,u.extend(e||{},{validationError:n})),!1):!0}});var m=["keys","values","pairs","invert","pick","omit"];u.each(m,function(t){p.prototype[t]=function(){var e=o.call(arguments);return e.unshift(this.attributes),u[t].apply(u,e)}});var v=t.Collection=function(t,e){e||(e={}),e.url&&(this.url=e.url),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,u.extend({silent:!0},e))},y={add:!0,remove:!0,merge:!0},w={add:!0,merge:!1,remove:!1};u.extend(v.prototype,l,{model:p,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return t.sync.apply(this,arguments)},add:function(t,e){return this.set(t,u.defaults(e||{},w))},remove:function(t,e){t=u.isArray(t)?t.slice():[t],e||(e={});var n,i,r,s;for(n=0,i=t.length;i>n;n++)s=this.get(t[n]),s&&(delete this._byId[s.id],delete this._byId[s.cid],r=this.indexOf(s),this.models.splice(r,1),this.length--,e.silent||(e.index=r,s.trigger("remove",s,this,e)),this._removeReference(s));return this},set:function(t,e){e=u.defaults(e||{},y),e.parse&&(t=this.parse(t,e)),u.isArray(t)||(t=t?[t]:[]);var n,i,r,o,l,h=e.at,c=this.comparator&&null==h&&e.sort!==!1,f=u.isString(this.comparator)?this.comparator:null,d=[],p=[],g={};for(n=0,i=t.length;i>n;n++)(r=this._prepareModel(t[n],e))&&((o=this.get(r))?(e.remove&&(g[o.cid]=!0),e.merge&&(o.set(r.attributes,e),c&&!l&&o.hasChanged(f)&&(l=!0))):e.add&&(d.push(r),r.on("all",this._onModelEvent,this),this._byId[r.cid]=r,null!=r.id&&(this._byId[r.id]=r)));if(e.remove){for(n=0,i=this.length;i>n;++n)g[(r=this.models[n]).cid]||p.push(r);p.length&&this.remove(p,e)}if(d.length&&(c&&(l=!0),this.length+=d.length,null!=h?a.apply(this.models,[h,0].concat(d)):s.apply(this.models,d)),l&&this.sort({silent:!0}),e.silent)return this;for(n=0,i=d.length;i>n;n++)(r=d[n]).trigger("add",r,this,e);return l&&this.trigger("sort",this,e),this},reset:function(t,e){e||(e={});for(var n=0,i=this.models.length;i>n;n++)this._removeReference(this.models[n]);return e.previousModels=this.models,this._reset(),this.add(t,u.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),this},push:function(t,e){return t=this._prepareModel(t,e),this.add(t,u.extend({at:this.length},e)),t},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return t=this._prepareModel(t,e),this.add(t,u.extend({at:0},e)),t},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(t,e){return this.models.slice(t,e)},get:function(t){return null==t?void 0:this._byId[null!=t.id?t.id:t.cid||t]},at:function(t){return this.models[t]},where:function(t,e){return u.isEmpty(t)?e?void 0:[]:this[e?"find":"filter"](function(e){for(var n in t)if(t[n]!==e.get(n))return!1;return!0})},findWhere:function(t){return this.where(t,!0)},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),u.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(u.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},sortedIndex:function(t,e,n){e||(e=this.comparator);var i=u.isFunction(e)?e:function(t){return t.get(e)};return u.sortedIndex(this.models,t,i,n)},pluck:function(t){return u.invoke(this.models,"get",t)},fetch:function(t){t=t?u.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success,n=this;return t.success=function(i){var r=t.reset?"reset":"set";n[r](i,t),e&&e(n,i,t),n.trigger("sync",n,i,t)},H(this,t),this.sync("read",this,t)},create:function(t,e){if(e=e?u.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var n=this,i=e.success;return e.success=function(r){e.wait&&n.add(t,e),i&&i(t,r,e)},t.save(null,e),t},parse:function(t){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(t instanceof p)return t.collection||(t.collection=this),t;e||(e={}),e.collection=this;var n=new this.model(t,e);return n._validate(t,e)?n:(this.trigger("invalid",this,t,e),!1)},_removeReference:function(t){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,i){("add"!==t&&"remove"!==t||n===this)&&("destroy"===t&&this.remove(e,i),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))}});var b=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];u.each(b,function(t){v.prototype[t]=function(){var e=o.call(arguments);return e.unshift(this.models),u[t].apply(u,e)}});var _=["groupBy","countBy","sortBy"];u.each(_,function(t){v.prototype[t]=function(e,n){var i=u.isFunction(e)?e:function(t){return t.get(e)};return u[t](this.models,i,n)}});var x=t.View=function(t){this.cid=u.uniqueId("view"),this._configure(t||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},C=/^(\S+)\s*(.*)$/,T=["model","collection","el","id","attributes","className","tagName","events"];u.extend(x.prototype,l,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,n){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(t){if(!t&&!(t=u.result(this,"events")))return this;this.undelegateEvents();for(var e in t){var n=t[e];if(u.isFunction(n)||(n=this[t[e]]),n){var i=e.match(C),r=i[1],s=i[2];n=u.bind(n,this),r+=".delegateEvents"+this.cid,""===s?this.$el.on(r,n):this.$el.on(r,s,n)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_configure:function(t){this.options&&(t=u.extend({},u.result(this,"options"),t)),u.extend(this,u.pick(t,T)),this.options=t},_ensureElement:function(){if(this.el)this.setElement(u.result(this,"el"),!1);else{var e=u.extend({},u.result(this,"attributes"));this.id&&(e.id=u.result(this,"id")),this.className&&(e["class"]=u.result(this,"className"));var n=t.$("<"+u.result(this,"tagName")+">").attr(e);this.setElement(n,!1)}}}),t.sync=function(e,n,i){var r=S[e];u.defaults(i||(i={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var s={type:r,dataType:"json"};if(i.url||(s.url=u.result(n,"url")||R()),null!=i.data||!n||"create"!==e&&"update"!==e&&"patch"!==e||(s.contentType="application/json",s.data=JSON.stringify(i.attrs||n.toJSON(i))),i.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),i.emulateHTTP&&("PUT"===r||"DELETE"===r||"PATCH"===r)){s.type="POST",i.emulateJSON&&(s.data._method=r);var o=i.beforeSend;i.beforeSend=function(t){return t.setRequestHeader("X-HTTP-Method-Override",r),o?o.apply(this,arguments):void 0}}"GET"===s.type||i.emulateJSON||(s.processData=!1),"PATCH"!==s.type||!window.ActiveXObject||window.external&&window.external.msActiveXFilteringEnabled||(s.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var a=i.xhr=t.ajax(u.extend(s,i));return n.trigger("request",n,a,i),a};var S={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var k=t.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},A=/\((.*?)\)/g,E=/(\(\?)?:\w+/g,M=/\*\w+/g,j=/[\-{}\[\]+?.,\\\^$|#\s]/g;u.extend(k.prototype,l,{initialize:function(){},route:function(e,n,i){u.isRegExp(e)||(e=this._routeToRegExp(e)),u.isFunction(n)&&(i=n,n=""),i||(i=this[n]);var r=this;return t.history.route(e,function(s){var o=r._extractParameters(e,s);i&&i.apply(r,o),r.trigger.apply(r,["route:"+n].concat(o)),r.trigger("route",n,o),t.history.trigger("route",r,n,o)}),this},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(this.routes){this.routes=u.result(this,"routes");for(var t,e=u.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(j,"\\$&").replace(A,"(?:$1)?").replace(E,function(t,e){return e?t:"([^/]+)"}).replace(M,"(.*?)"),new RegExp("^"+t+"$")},_extractParameters:function(t,e){var n=t.exec(e).slice(1);return u.map(n,function(t){return t?decodeURIComponent(t):null})}});var O=t.History=function(){this.handlers=[],u.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},L=/^[#\/]|\s+$/g,z=/^\/+|\/+$/g,I=/msie [\w.]+/,$=/\/$/;O.started=!1,u.extend(O.prototype,l,{interval:50,getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=this.location.pathname;var n=this.root.replace($,"");t.indexOf(n)||(t=t.substr(n.length))}else t=this.getHash();return t.replace(L,"")},start:function(e){if(O.started)throw new Error("Backbone.history has already been started");O.started=!0,this.options=u.extend({},{root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);
var n=this.getFragment(),i=document.documentMode,r=I.exec(navigator.userAgent.toLowerCase())&&(!i||7>=i);this.root=("/"+this.root+"/").replace(z,"/"),r&&this._wantsHashChange&&(this.iframe=t.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(n)),this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=n;var s=this.location,o=s.pathname.replace(/[^\/]$/,"$&/")===this.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!o?(this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&o&&s.hash&&(this.fragment=this.getHash().replace(L,""),this.history.replaceState({},document.title,this.root+this.fragment+s.search)),this.options.silent?void 0:this.loadUrl())},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),O.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t===this.fragment?!1:(this.iframe&&this.navigate(t),void(this.loadUrl()||this.loadUrl(this.getHash())))},loadUrl:function(t){var e=this.fragment=this.getFragment(t),n=u.any(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0});return n},navigate:function(t,e){if(!O.started)return!1;if(e&&e!==!0||(e={trigger:e}),t=this.getFragment(t||""),this.fragment!==t){this.fragment=t;var n=this.root+t;if(this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}e.trigger&&this.loadUrl(t)}},_updateHash:function(t,e,n){if(n){var i=t.href.replace(/(javascript:|#).*$/,"");t.replace(i+"#"+e)}else t.hash="#"+e}}),t.history=new O;var P=function(t,e){var n,i=this;n=t&&u.has(t,"constructor")?t.constructor:function(){return i.apply(this,arguments)},u.extend(n,i,e);var r=function(){this.constructor=n};return r.prototype=i.prototype,n.prototype=new r,t&&u.extend(n.prototype,t),n.__super__=i.prototype,n};p.extend=v.extend=k.extend=x.extend=O.extend=P;var R=function(){throw new Error('A "url" property or function must be specified')},H=function(t,e){var n=e.error;e.error=function(i){n&&n(t,i,e),t.trigger("error",t,i,e)}}}.call(this),n("backbone",["underscore","jquery"],function(t){return function(){var e;return e||t.Backbone}}(this)),n("gallery/models/image.model",["backbone"],function(t){var e=t.Model.extend({idAttribute:"digest",defaults:function(){return{thumb:{src:void 0,width:void 0,height:void 0,_view:void 0},large:{src:void 0,width:void 0,height:void 0,_view:void 0},filename:void 0,digest:void 0,index:void 0,orientation:void 0,ratio:0,exif:{}}},initialize:function(t,e){_.forEach(e.presets,_.bind(function(e,n){this.attributes[n].src=e.baseurl+"/"+t.filename},this))},getThumbView:function(){return this.attributes.thumb._view},setThumbView:function(t){this.attributes.thumb._view=t},getLargeView:function(){return this.attributes.large._view},setLargeView:function(t){this.attributes.large._view=t},index:function(){return this.attributes.index}});return e}),n("gallery/collections/image.collection",["backbone","gallery/models/image.model"],function(t,e){var n=t.Collection.extend({model:e,nextOrder:function(){return this.length?this.last().get("order")+1:1},comparator:"order"});return n}),n("gallery/models/gallery.model",["backbone","gallery/collections/image.collection"],function(t,e){var n=t.Model.extend({idAttribute:"project",defaults:function(){return{project:"",title:"",presets:{thumb:{width:300},large:{width:800}},images:void 0}},initialize:function(){this.sliderState="closed",this._current=void 0},toggleSliderState:function(){this.sliderState="closed"==this.sliderState?"opened":"closed"},url:function(){return this.get("project")+".json"},parse:function(t){var n=t.gallery;return image_options={presets:n.presets},this.attributes&&this.attributes.images?this.attributes.images.reset(n.images,image_options):n.images=new e(n.images,image_options),n},setCurrent:function(t){this._current=t},getCurrent:function(){return this._current},getNext:function(){if(this._current){var t=this.attributes.images;if(this._current.index()<t.length-1)return t.at(this._current.index()+1)}},getPrev:function(){return this._current&&this._current.index()>0?this.attributes.images.at(this._current.index()-1):void 0}});return n}),function(t,e){var n="ui-effects-";t.effects={effect:{}},function(t,e){function n(t,e,n){var i=c[e.type]||{};return null==t?n||!e.def?null:e.def:(t=i.floor?~~t:parseFloat(t),isNaN(t)?e.def:i.mod?(t+i.mod)%i.mod:0>t?0:i.max<t?i.max:t)}function i(e){var n=l(),i=n._rgba=[];return e=e.toLowerCase(),p(u,function(t,r){var s,o=r.re.exec(e),a=o&&r.parse(o),u=r.space||"rgba";return a?(s=n[u](a),n[h[u].cache]=s[h[u].cache],i=n._rgba=s._rgba,!1):void 0}),i.length?("0,0,0,0"===i.join()&&t.extend(i,s.transparent),n):s[e]}function r(t,e,n){return n=(n+1)%1,1>6*n?t+(e-t)*n*6:1>2*n?e:2>3*n?t+(e-t)*(2/3-n)*6:t}var s,o="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",a=/^([\-+])=\s*(\d+\.?\d*)/,u=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[t[1],t[2],t[3],t[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[2.55*t[1],2.55*t[2],2.55*t[3],t[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(t){return[t[1],t[2]/100,t[3]/100,t[4]]}}],l=t.Color=function(e,n,i,r){return new t.Color.fn.parse(e,n,i,r)},h={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},c={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},f=l.support={},d=t("<p>")[0],p=t.each;d.style.cssText="background-color:rgba(1,1,1,.5)",f.rgba=d.style.backgroundColor.indexOf("rgba")>-1,p(h,function(t,e){e.cache="_"+t,e.props.alpha={idx:3,type:"percent",def:1}}),l.fn=t.extend(l.prototype,{parse:function(r,o,a,u){if(r===e)return this._rgba=[null,null,null,null],this;(r.jquery||r.nodeType)&&(r=t(r).css(o),o=e);var c=this,f=t.type(r),d=this._rgba=[];return o!==e&&(r=[r,o,a,u],f="array"),"string"===f?this.parse(i(r)||s._default):"array"===f?(p(h.rgba.props,function(t,e){d[e.idx]=n(r[e.idx],e)}),this):"object"===f?(r instanceof l?p(h,function(t,e){r[e.cache]&&(c[e.cache]=r[e.cache].slice())}):p(h,function(e,i){var s=i.cache;p(i.props,function(t,e){if(!c[s]&&i.to){if("alpha"===t||null==r[t])return;c[s]=i.to(c._rgba)}c[s][e.idx]=n(r[t],e,!0)}),c[s]&&t.inArray(null,c[s].slice(0,3))<0&&(c[s][3]=1,i.from&&(c._rgba=i.from(c[s])))}),this):void 0},is:function(t){var e=l(t),n=!0,i=this;return p(h,function(t,r){var s,o=e[r.cache];return o&&(s=i[r.cache]||r.to&&r.to(i._rgba)||[],p(r.props,function(t,e){return null!=o[e.idx]?n=o[e.idx]===s[e.idx]:void 0})),n}),n},_space:function(){var t=[],e=this;return p(h,function(n,i){e[i.cache]&&t.push(n)}),t.pop()},transition:function(t,e){var i=l(t),r=i._space(),s=h[r],o=0===this.alpha()?l("transparent"):this,a=o[s.cache]||s.to(o._rgba),u=a.slice();return i=i[s.cache],p(s.props,function(t,r){var s=r.idx,o=a[s],l=i[s],h=c[r.type]||{};null!==l&&(null===o?u[s]=l:(h.mod&&(l-o>h.mod/2?o+=h.mod:o-l>h.mod/2&&(o-=h.mod)),u[s]=n((l-o)*e+o,r)))}),this[r](u)},blend:function(e){if(1===this._rgba[3])return this;var n=this._rgba.slice(),i=n.pop(),r=l(e)._rgba;return l(t.map(n,function(t,e){return(1-i)*r[e]+i*t}))},toRgbaString:function(){var e="rgba(",n=t.map(this._rgba,function(t,e){return null==t?e>2?1:0:t});return 1===n[3]&&(n.pop(),e="rgb("),e+n.join()+")"},toHslaString:function(){var e="hsla(",n=t.map(this.hsla(),function(t,e){return null==t&&(t=e>2?1:0),e&&3>e&&(t=Math.round(100*t)+"%"),t});return 1===n[3]&&(n.pop(),e="hsl("),e+n.join()+")"},toHexString:function(e){var n=this._rgba.slice(),i=n.pop();return e&&n.push(~~(255*i)),"#"+t.map(n,function(t){return t=(t||0).toString(16),1===t.length?"0"+t:t}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),l.fn.parse.prototype=l.fn,h.hsla.to=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e,n,i=t[0]/255,r=t[1]/255,s=t[2]/255,o=t[3],a=Math.max(i,r,s),u=Math.min(i,r,s),l=a-u,h=a+u,c=.5*h;return e=u===a?0:i===a?60*(r-s)/l+360:r===a?60*(s-i)/l+120:60*(i-r)/l+240,n=0===l?0:.5>=c?l/h:l/(2-h),[Math.round(e)%360,n,c,null==o?1:o]},h.hsla.from=function(t){if(null==t[0]||null==t[1]||null==t[2])return[null,null,null,t[3]];var e=t[0]/360,n=t[1],i=t[2],s=t[3],o=.5>=i?i*(1+n):i+n-i*n,a=2*i-o;return[Math.round(255*r(a,o,e+1/3)),Math.round(255*r(a,o,e)),Math.round(255*r(a,o,e-1/3)),s]},p(h,function(i,r){var s=r.props,o=r.cache,u=r.to,h=r.from;l.fn[i]=function(i){if(u&&!this[o]&&(this[o]=u(this._rgba)),i===e)return this[o].slice();var r,a=t.type(i),c="array"===a||"object"===a?i:arguments,f=this[o].slice();return p(s,function(t,e){var i=c["object"===a?t:e.idx];null==i&&(i=f[e.idx]),f[e.idx]=n(i,e)}),h?(r=l(h(f)),r[o]=f,r):l(f)},p(s,function(e,n){l.fn[e]||(l.fn[e]=function(r){var s,o=t.type(r),u="alpha"===e?this._hsla?"hsla":"rgba":i,l=this[u](),h=l[n.idx];return"undefined"===o?h:("function"===o&&(r=r.call(this,h),o=t.type(r)),null==r&&n.empty?this:("string"===o&&(s=a.exec(r),s&&(r=h+parseFloat(s[2])*("+"===s[1]?1:-1))),l[n.idx]=r,this[u](l)))})})}),l.hook=function(e){var n=e.split(" ");p(n,function(e,n){t.cssHooks[n]={set:function(e,r){var s,o,a="";if("transparent"!==r&&("string"!==t.type(r)||(s=i(r)))){if(r=l(s||r),!f.rgba&&1!==r._rgba[3]){for(o="backgroundColor"===n?e.parentNode:e;(""===a||"transparent"===a)&&o&&o.style;)try{a=t.css(o,"backgroundColor"),o=o.parentNode}catch(u){}r=r.blend(a&&"transparent"!==a?a:"_default")}r=r.toRgbaString()}try{e.style[n]=r}catch(u){}}},t.fx.step[n]=function(e){e.colorInit||(e.start=l(e.elem,n),e.end=l(e.end),e.colorInit=!0),t.cssHooks[n].set(e.elem,e.start.transition(e.end,e.pos))}})},l.hook(o),t.cssHooks.borderColor={expand:function(t){var e={};return p(["Top","Right","Bottom","Left"],function(n,i){e["border"+i+"Color"]=t}),e}},s=t.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function n(e){var n,i,r=e.ownerDocument.defaultView?e.ownerDocument.defaultView.getComputedStyle(e,null):e.currentStyle,s={};if(r&&r.length&&r[0]&&r[r[0]])for(i=r.length;i--;)n=r[i],"string"==typeof r[n]&&(s[t.camelCase(n)]=r[n]);else for(n in r)"string"==typeof r[n]&&(s[n]=r[n]);return s}function i(e,n){var i,r,o={};for(i in n)r=n[i],e[i]!==r&&(s[i]||(t.fx.step[i]||!isNaN(parseFloat(r)))&&(o[i]=r));return o}var r=["add","remove","toggle"],s={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};t.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(e,n){t.fx.step[n]=function(t){("none"!==t.end&&!t.setAttr||1===t.pos&&!t.setAttr)&&(jQuery.style(t.elem,n,t.end),t.setAttr=!0)}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t.effects.animateClass=function(e,s,o,a){var u=t.speed(s,o,a);return this.queue(function(){var s,o=t(this),a=o.attr("class")||"",l=u.children?o.find("*").addBack():o;l=l.map(function(){var e=t(this);return{el:e,start:n(this)}}),s=function(){t.each(r,function(t,n){e[n]&&o[n+"Class"](e[n])})},s(),l=l.map(function(){return this.end=n(this.el[0]),this.diff=i(this.start,this.end),this}),o.attr("class",a),l=l.map(function(){var e=this,n=t.Deferred(),i=t.extend({},u,{queue:!1,complete:function(){n.resolve(e)}});return this.el.animate(this.diff,i),n.promise()}),t.when.apply(t,l.get()).done(function(){s(),t.each(arguments,function(){var e=this.el;t.each(this.diff,function(t){e.css(t,"")})}),u.complete.call(o[0])})})},t.fn.extend({addClass:function(e){return function(n,i,r,s){return i?t.effects.animateClass.call(this,{add:n},i,r,s):e.apply(this,arguments)}}(t.fn.addClass),removeClass:function(e){return function(n,i,r,s){return arguments.length>1?t.effects.animateClass.call(this,{remove:n},i,r,s):e.apply(this,arguments)}}(t.fn.removeClass),toggleClass:function(n){return function(i,r,s,o,a){return"boolean"==typeof r||r===e?s?t.effects.animateClass.call(this,r?{add:i}:{remove:i},s,o,a):n.apply(this,arguments):t.effects.animateClass.call(this,{toggle:i},r,s,o)}}(t.fn.toggleClass),switchClass:function(e,n,i,r,s){return t.effects.animateClass.call(this,{add:n,remove:e},i,r,s)}})}(),function(){function i(e,n,i,r){return t.isPlainObject(e)&&(n=e,e=e.effect),e={effect:e},null==n&&(n={}),t.isFunction(n)&&(r=n,i=null,n={}),("number"==typeof n||t.fx.speeds[n])&&(r=i,i=n,n={}),t.isFunction(i)&&(r=i,i=null),n&&t.extend(e,n),i=i||n.duration,e.duration=t.fx.off?0:"number"==typeof i?i:i in t.fx.speeds?t.fx.speeds[i]:t.fx.speeds._default,e.complete=r||n.complete,e}function r(e){return!e||"number"==typeof e||t.fx.speeds[e]?!0:"string"!=typeof e||t.effects.effect[e]?t.isFunction(e)?!0:"object"!=typeof e||e.effect?!1:!0:!0}t.extend(t.effects,{version:"1.10.4",save:function(t,e){for(var i=0;i<e.length;i++)null!==e[i]&&t.data(n+e[i],t[0].style[e[i]])},restore:function(t,i){var r,s;for(s=0;s<i.length;s++)null!==i[s]&&(r=t.data(n+i[s]),r===e&&(r=""),t.css(i[s],r))},setMode:function(t,e){return"toggle"===e&&(e=t.is(":hidden")?"show":"hide"),e},getBaseline:function(t,e){var n,i;switch(t[0]){case"top":n=0;break;case"middle":n=.5;break;case"bottom":n=1;break;default:n=t[0]/e.height}switch(t[1]){case"left":i=0;break;case"center":i=.5;break;case"right":i=1;break;default:i=t[1]/e.width}return{x:i,y:n}},createWrapper:function(e){if(e.parent().is(".ui-effects-wrapper"))return e.parent();var n={width:e.outerWidth(!0),height:e.outerHeight(!0),"float":e.css("float")},i=t("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),r={width:e.width(),height:e.height()},s=document.activeElement;try{s.id}catch(o){s=document.body}return e.wrap(i),(e[0]===s||t.contains(e[0],s))&&t(s).focus(),i=e.parent(),"static"===e.css("position")?(i.css({position:"relative"}),e.css({position:"relative"})):(t.extend(n,{position:e.css("position"),zIndex:e.css("z-index")}),t.each(["top","left","bottom","right"],function(t,i){n[i]=e.css(i),isNaN(parseInt(n[i],10))&&(n[i]="auto")}),e.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),e.css(r),i.css(n).show()},removeWrapper:function(e){var n=document.activeElement;return e.parent().is(".ui-effects-wrapper")&&(e.parent().replaceWith(e),(e[0]===n||t.contains(e[0],n))&&t(n).focus()),e},setTransition:function(e,n,i,r){return r=r||{},t.each(n,function(t,n){var s=e.cssUnit(n);s[0]>0&&(r[n]=s[0]*i+s[1])}),r}}),t.fn.extend({effect:function(){function e(e){function i(){t.isFunction(s)&&s.call(r[0]),t.isFunction(e)&&e()}var r=t(this),s=n.complete,a=n.mode;(r.is(":hidden")?"hide"===a:"show"===a)?(r[a](),i()):o.call(r[0],n,i)}var n=i.apply(this,arguments),r=n.mode,s=n.queue,o=t.effects.effect[n.effect];return t.fx.off||!o?r?this[r](n.duration,n.complete):this.each(function(){n.complete&&n.complete.call(this)}):s===!1?this.each(e):this.queue(s||"fx",e)},show:function(t){return function(e){if(r(e))return t.apply(this,arguments);var n=i.apply(this,arguments);return n.mode="show",this.effect.call(this,n)}}(t.fn.show),hide:function(t){return function(e){if(r(e))return t.apply(this,arguments);var n=i.apply(this,arguments);return n.mode="hide",this.effect.call(this,n)}}(t.fn.hide),toggle:function(t){return function(e){if(r(e)||"boolean"==typeof e)return t.apply(this,arguments);var n=i.apply(this,arguments);return n.mode="toggle",this.effect.call(this,n)}}(t.fn.toggle),cssUnit:function(e){var n=this.css(e),i=[];return t.each(["em","px","%","pt"],function(t,e){n.indexOf(e)>0&&(i=[parseFloat(n),e])}),i}})}(),function(){var e={};t.each(["Quad","Cubic","Quart","Quint","Expo"],function(t,n){e[n]=function(e){return Math.pow(e,t+2)}}),t.extend(e,{Sine:function(t){return 1-Math.cos(t*Math.PI/2)},Circ:function(t){return 1-Math.sqrt(1-t*t)},Elastic:function(t){return 0===t||1===t?t:-Math.pow(2,8*(t-1))*Math.sin((80*(t-1)-7.5)*Math.PI/15)},Back:function(t){return t*t*(3*t-2)},Bounce:function(t){for(var e,n=4;t<((e=Math.pow(2,--n))-1)/11;);return 1/Math.pow(4,3-n)-7.5625*Math.pow((3*e-2)/22-t,2)}}),t.each(e,function(e,n){t.easing["easeIn"+e]=n,t.easing["easeOut"+e]=function(t){return 1-n(1-t)},t.easing["easeInOut"+e]=function(t){return.5>t?n(2*t)/2:1-n(-2*t+2)/2}})}()}(jQuery),n("jqueryui",function(){}),function(t,e){var n,i=t.jQuery||t.Cowboy||(t.Cowboy={});i.throttle=n=function(t,n,r,s){function o(){function i(){u=+new Date,r.apply(l,c)}function o(){a=e}var l=this,h=+new Date-u,c=arguments;s&&!a&&i(),a&&clearTimeout(a),s===e&&h>t?i():n!==!0&&(a=setTimeout(s?o:i,s===e?t-h:t))}var a,u=0;return"boolean"!=typeof n&&(s=r,r=n,n=e),i.guid&&(o.guid=r.guid=r.guid||i.guid++),o},i.debounce=function(t,i,r){return r===e?n(t,i,!1):n(t,r,i!==!1)}}(this),n("vendor/jquery.throttle-debounce",function(){}),function(t,e){var n,i=t.document,r=i.documentElement,s=t.Modernizr,o=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},a="Moz Webkit O Ms".split(" "),u=function(t){var e,n=r.style;if("string"==typeof n[t])return t;t=o(t);for(var i=0,s=a.length;s>i;i++)if(e=a[i]+t,"string"==typeof n[e])return e},l=u("transform"),h=u("transitionProperty"),c={csstransforms:function(){return!!l},csstransforms3d:function(){var t=!!u("perspective");if(t&&"webkitPerspective"in r.style){var n=e("<style>@media (transform-3d),(-webkit-transform-3d){#modernizr{height:3px}}</style>").appendTo("head"),i=e('<div id="modernizr" />').appendTo("html");t=3===i.height(),i.remove(),n.remove()}return t},csstransitions:function(){return!!h}};if(s)for(n in c)s.hasOwnProperty(n)||s.addTest(n,c[n]);else{s=t.Modernizr={_version:"1.6ish: miniModernizr for Isotope"};var f,d=" ";for(n in c)f=c[n](),s[n]=f,d+=" "+(f?"":"no-")+n;e("html").addClass(d)}if(s.csstransforms){var p=s.csstransforms3d?{translate:function(t){return"translate3d("+t[0]+"px, "+t[1]+"px, 0) "},scale:function(t){return"scale3d("+t+", "+t+", 1) "}}:{translate:function(t){return"translate("+t[0]+"px, "+t[1]+"px) "},scale:function(t){return"scale("+t+") "}},g=function(t,n,i){var r,s,o=e.data(t,"isoTransform")||{},a={},u={};a[n]=i,e.extend(o,a);for(r in o)s=o[r],u[r]=p[r](s);var h=u.translate||"",c=u.scale||"",f=h+c;e.data(t,"isoTransform",o),t.style[l]=f};e.cssNumber.scale=!0,e.cssHooks.scale={set:function(t,e){g(t,"scale",e)},get:function(t){var n=e.data(t,"isoTransform");return n&&n.scale?n.scale:1}},e.fx.step.scale=function(t){e.cssHooks.scale.set(t.elem,t.now+t.unit)},e.cssNumber.translate=!0,e.cssHooks.translate={set:function(t,e){g(t,"translate",e)},get:function(t){var n=e.data(t,"isoTransform");return n&&n.translate?n.translate:[0,0]}}}var m,v;s.csstransitions&&(m={WebkitTransitionProperty:"webkitTransitionEnd",MozTransitionProperty:"transitionend",OTransitionProperty:"oTransitionEnd otransitionend",transitionProperty:"transitionend"}[h],v=u("transitionDuration"));var y,w=e.event,b=e.event.handle?"handle":"dispatch";w.special.smartresize={setup:function(){e(this).bind("resize",w.special.smartresize.handler)},teardown:function(){e(this).unbind("resize",w.special.smartresize.handler)},handler:function(t,e){var n=this,i=arguments;t.type="smartresize",y&&clearTimeout(y),y=setTimeout(function(){w[b].apply(n,i)},"execAsap"===e?0:100)}},e.fn.smartresize=function(t){return t?this.bind("smartresize",t):this.trigger("smartresize",["execAsap"])},e.Isotope=function(t,n,i){this.element=e(n),this._create(t),this._init(i)};var _=["width","height"],x=e(t);e.Isotope.settings={resizable:!0,layoutMode:"masonry",containerClass:"isotope",itemClass:"isotope-item",hiddenClass:"isotope-hidden",hiddenStyle:{opacity:0,scale:.001},visibleStyle:{opacity:1,scale:1},containerStyle:{position:"relative",overflow:"hidden"},animationEngine:"best-available",animationOptions:{queue:!1,duration:800},sortBy:"original-order",sortAscending:!0,resizesContainer:!0,transformsEnabled:!0,itemPositionDataEnabled:!1},e.Isotope.prototype={_create:function(t){this.options=e.extend({},e.Isotope.settings,t),this.styleQueue=[],this.elemCount=0;var n=this.element[0].style;this.originalStyle={};var i=_.slice(0);for(var r in this.options.containerStyle)i.push(r);for(var s=0,o=i.length;o>s;s++)r=i[s],this.originalStyle[r]=n[r]||"";this.element.css(this.options.containerStyle),this._updateAnimationEngine(),this._updateUsingTransforms();var a={"original-order":function(t,e){return e.elemCount++,e.elemCount},random:function(){return Math.random()}};this.options.getSortData=e.extend(this.options.getSortData,a),this.reloadItems(),this.offset={left:parseInt(this.element.css("padding-left")||0,10),top:parseInt(this.element.css("padding-top")||0,10)};var u=this;setTimeout(function(){u.element.addClass(u.options.containerClass)},0),this.options.resizable&&x.bind("smartresize.isotope",function(){u.resize()}),this.element.delegate("."+this.options.hiddenClass,"click",function(){return!1})},_getAtoms:function(t){var e=this.options.itemSelector,n=e?t.filter(e).add(t.find(e)):t,i={position:"absolute"};return n=n.filter(function(t,e){return 1===e.nodeType}),this.usingTransforms&&(i.left=0,i.top=0),n.css(i).addClass(this.options.itemClass),this.updateSortData(n,!0),n},_init:function(t){this.$filteredAtoms=this._filter(this.$allAtoms),this._sort(),this.reLayout(t)},option:function(t){if(e.isPlainObject(t)){this.options=e.extend(!0,this.options,t);var n;for(var i in t)n="_update"+o(i),this[n]&&this[n]()}},_updateAnimationEngine:function(){var t,e=this.options.animationEngine.toLowerCase().replace(/[ _\-]/g,"");switch(e){case"css":case"none":t=!1;break;case"jquery":t=!0;break;default:t=!s.csstransitions}this.isUsingJQueryAnimation=t,this._updateUsingTransforms()},_updateTransformsEnabled:function(){this._updateUsingTransforms()},_updateUsingTransforms:function(){var t=this.usingTransforms=this.options.transformsEnabled&&s.csstransforms&&s.csstransitions&&!this.isUsingJQueryAnimation;t||(delete this.options.hiddenStyle.scale,delete this.options.visibleStyle.scale),this.getPositionStyles=t?this._translate:this._positionAbs},_filter:function(t){var e=""===this.options.filter?"*":this.options.filter;if(!e)return t;var n=this.options.hiddenClass,i="."+n,r=t.filter(i),s=r;if("*"!==e){s=r.filter(e);var o=t.not(i).not(e).addClass(n);this.styleQueue.push({$el:o,style:this.options.hiddenStyle})}return this.styleQueue.push({$el:s,style:this.options.visibleStyle}),s.removeClass(n),t.filter(e)},updateSortData:function(t,n){var i,r,s=this,o=this.options.getSortData;t.each(function(){i=e(this),r={};for(var t in o)r[t]=n||"original-order"!==t?o[t](i,s):e.data(this,"isotope-sort-data")[t];e.data(this,"isotope-sort-data",r)})},_sort:function(){var t=this.options.sortBy,e=this._getSorter,n=this.options.sortAscending?1:-1,i=function(i,r){var s=e(i,t),o=e(r,t);return s===o&&"original-order"!==t&&(s=e(i,"original-order"),o=e(r,"original-order")),(s>o?1:o>s?-1:0)*n};this.$filteredAtoms.sort(i)},_getSorter:function(t,n){return e.data(t,"isotope-sort-data")[n]},_translate:function(t,e){return{translate:[t,e]}},_positionAbs:function(t,e){return{left:t,top:e}},_pushPosition:function(t,e,n){e=Math.round(e+this.offset.left),n=Math.round(n+this.offset.top);var i=this.getPositionStyles(e,n);this.styleQueue.push({$el:t,style:i}),this.options.itemPositionDataEnabled&&t.data("isotope-item-position",{x:e,y:n})},layout:function(t,e){var n=this.options.layoutMode;if(this["_"+n+"Layout"](t),this.options.resizesContainer){var i=this["_"+n+"GetContainerSize"]();this.styleQueue.push({$el:this.element,style:i})}this._processStyleQueue(t,e),this.isLaidOut=!0},_processStyleQueue:function(t,n){var i,r,o,a,u=this.isLaidOut?this.isUsingJQueryAnimation?"animate":"css":"css",l=this.options.animationOptions,h=this.options.onLayout;if(r=function(t,e){e.$el[u](e.style,l)},this._isInserting&&this.isUsingJQueryAnimation)r=function(t,e){i=e.$el.hasClass("no-transition")?"css":u,e.$el[i](e.style,l)};else if(n||h||l.complete){var c=!1,f=[n,h,l.complete],d=this;if(o=!0,a=function(){if(!c){for(var e,n=0,i=f.length;i>n;n++)e=f[n],"function"==typeof e&&e.call(d.element,t,d);c=!0}},this.isUsingJQueryAnimation&&"animate"===u)l.complete=a,o=!1;else if(s.csstransitions){for(var p,g=0,y=this.styleQueue[0],w=y&&y.$el;!w||!w.length;){if(p=this.styleQueue[g++],!p)return;w=p.$el}var b=parseFloat(getComputedStyle(w[0])[v]);b>0&&(r=function(t,e){e.$el[u](e.style,l).one(m,a)},o=!1)}}e.each(this.styleQueue,r),o&&a(),this.styleQueue=[]},resize:function(){this["_"+this.options.layoutMode+"ResizeChanged"]()&&this.reLayout()},reLayout:function(t){this["_"+this.options.layoutMode+"Reset"](),this.layout(this.$filteredAtoms,t)},addItems:function(t,e){var n=this._getAtoms(t);this.$allAtoms=this.$allAtoms.add(n),e&&e(n)},insert:function(t,e){this.element.append(t);var n=this;this.addItems(t,function(t){var i=n._filter(t);n._addHideAppended(i),n._sort(),n.reLayout(),n._revealAppended(i,e)})},appended:function(t,e){var n=this;this.addItems(t,function(t){n._addHideAppended(t),n.layout(t),n._revealAppended(t,e)})},_addHideAppended:function(t){this.$filteredAtoms=this.$filteredAtoms.add(t),t.addClass("no-transition"),this._isInserting=!0,this.styleQueue.push({$el:t,style:this.options.hiddenStyle})},_revealAppended:function(t,e){var n=this;setTimeout(function(){t.removeClass("no-transition"),n.styleQueue.push({$el:t,style:n.options.visibleStyle}),n._isInserting=!1,n._processStyleQueue(t,e)},10)},reloadItems:function(){this.$allAtoms=this._getAtoms(this.element.children())},remove:function(t,e){this.$allAtoms=this.$allAtoms.not(t),this.$filteredAtoms=this.$filteredAtoms.not(t);var n=this,i=function(){t.remove(),e&&e.call(n.element)};t.filter(":not(."+this.options.hiddenClass+")").length?(this.styleQueue.push({$el:t,style:this.options.hiddenStyle}),this._sort(),this.reLayout(i)):i()},shuffle:function(t){this.updateSortData(this.$allAtoms),this.options.sortBy="random",this._sort(),this.reLayout(t)},destroy:function(){var t=this.usingTransforms,e=this.options;this.$allAtoms.removeClass(e.hiddenClass+" "+e.itemClass).each(function(){var e=this.style;e.position="",e.top="",e.left="",e.opacity="",t&&(e[l]="")});var n=this.element[0].style;for(var i in this.originalStyle)n[i]=this.originalStyle[i];this.element.unbind(".isotope").undelegate("."+e.hiddenClass,"click").removeClass(e.containerClass).removeData("isotope"),x.unbind(".isotope")},_getSegments:function(t){var e,n=this.options.layoutMode,i=t?"rowHeight":"columnWidth",r=t?"height":"width",s=t?"rows":"cols",a=this.element[r](),u=this.options[n]&&this.options[n][i]||this.$filteredAtoms["outer"+o(r)](!0)||a;e=Math.floor(a/u),e=Math.max(e,1),this[n][s]=e,this[n][i]=u},_checkIfSegmentsChanged:function(t){var e=this.options.layoutMode,n=t?"rows":"cols",i=this[e][n];return this._getSegments(t),this[e][n]!==i},_masonryReset:function(){this.masonry={},this._getSegments();var t=this.masonry.cols;for(this.masonry.colYs=[];t--;)this.masonry.colYs.push(0)},_masonryLayout:function(t){var n=this,i=n.masonry;t.each(function(){var t=e(this),r=Math.ceil(t.outerWidth(!0)/i.columnWidth);if(r=Math.min(r,i.cols),1===r)n._masonryPlaceBrick(t,i.colYs);else{var s,o,a=i.cols+1-r,u=[];for(o=0;a>o;o++)s=i.colYs.slice(o,o+r),u[o]=Math.max.apply(Math,s);n._masonryPlaceBrick(t,u)}})},_masonryPlaceBrick:function(t,e){for(var n=Math.min.apply(Math,e),i=0,r=0,s=e.length;s>r;r++)if(e[r]===n){i=r;break}var o=this.masonry.columnWidth*i,a=n;this._pushPosition(t,o,a);var u=n+t.outerHeight(!0),l=this.masonry.cols+1-s;for(r=0;l>r;r++)this.masonry.colYs[i+r]=u},_masonryGetContainerSize:function(){var t=Math.max.apply(Math,this.masonry.colYs);return{height:t}},_masonryResizeChanged:function(){return this._checkIfSegmentsChanged()},_fitRowsReset:function(){this.fitRows={x:0,y:0,height:0}},_fitRowsLayout:function(t){var n=this,i=this.element.width(),r=this.fitRows;t.each(function(){var t=e(this),s=t.outerWidth(!0),o=t.outerHeight(!0);0!==r.x&&s+r.x>i&&(r.x=0,r.y=r.height),n._pushPosition(t,r.x,r.y),r.height=Math.max(r.y+o,r.height),r.x+=s})},_fitRowsGetContainerSize:function(){return{height:this.fitRows.height}},_fitRowsResizeChanged:function(){return!0},_cellsByRowReset:function(){this.cellsByRow={index:0},this._getSegments(),this._getSegments(!0)},_cellsByRowLayout:function(t){var n=this,i=this.cellsByRow;t.each(function(){var t=e(this),r=i.index%i.cols,s=Math.floor(i.index/i.cols),o=(r+.5)*i.columnWidth-t.outerWidth(!0)/2,a=(s+.5)*i.rowHeight-t.outerHeight(!0)/2;n._pushPosition(t,o,a),i.index++})},_cellsByRowGetContainerSize:function(){return{height:Math.ceil(this.$filteredAtoms.length/this.cellsByRow.cols)*this.cellsByRow.rowHeight+this.offset.top}},_cellsByRowResizeChanged:function(){return this._checkIfSegmentsChanged()},_straightDownReset:function(){this.straightDown={y:0}},_straightDownLayout:function(t){var n=this;t.each(function(){var t=e(this);n._pushPosition(t,0,n.straightDown.y),n.straightDown.y+=t.outerHeight(!0)})},_straightDownGetContainerSize:function(){return{height:this.straightDown.y}},_straightDownResizeChanged:function(){return!0},_masonryHorizontalReset:function(){this.masonryHorizontal={},this._getSegments(!0);var t=this.masonryHorizontal.rows;for(this.masonryHorizontal.rowXs=[];t--;)this.masonryHorizontal.rowXs.push(0)},_masonryHorizontalLayout:function(t){var n=this,i=n.masonryHorizontal;t.each(function(){var t=e(this),r=Math.ceil(t.outerHeight(!0)/i.rowHeight);if(r=Math.min(r,i.rows),1===r)n._masonryHorizontalPlaceBrick(t,i.rowXs);else{var s,o,a=i.rows+1-r,u=[];for(o=0;a>o;o++)s=i.rowXs.slice(o,o+r),u[o]=Math.max.apply(Math,s);n._masonryHorizontalPlaceBrick(t,u)}})},_masonryHorizontalPlaceBrick:function(t,e){for(var n=Math.min.apply(Math,e),i=0,r=0,s=e.length;s>r;r++)if(e[r]===n){i=r;break}var o=n,a=this.masonryHorizontal.rowHeight*i;this._pushPosition(t,o,a);var u=n+t.outerWidth(!0),l=this.masonryHorizontal.rows+1-s;for(r=0;l>r;r++)this.masonryHorizontal.rowXs[i+r]=u},_masonryHorizontalGetContainerSize:function(){var t=Math.max.apply(Math,this.masonryHorizontal.rowXs);return{width:t}},_masonryHorizontalResizeChanged:function(){return this._checkIfSegmentsChanged(!0)},_fitColumnsReset:function(){this.fitColumns={x:0,y:0,width:0}},_fitColumnsLayout:function(t){var n=this,i=this.element.height(),r=this.fitColumns;t.each(function(){var t=e(this),s=t.outerWidth(!0),o=t.outerHeight(!0);0!==r.y&&o+r.y>i&&(r.x=r.width,r.y=0),n._pushPosition(t,r.x,r.y),r.width=Math.max(r.x+s,r.width),r.y+=o})},_fitColumnsGetContainerSize:function(){return{width:this.fitColumns.width}},_fitColumnsResizeChanged:function(){return!0},_cellsByColumnReset:function(){this.cellsByColumn={index:0},this._getSegments(),this._getSegments(!0)
},_cellsByColumnLayout:function(t){var n=this,i=this.cellsByColumn;t.each(function(){var t=e(this),r=Math.floor(i.index/i.rows),s=i.index%i.rows,o=(r+.5)*i.columnWidth-t.outerWidth(!0)/2,a=(s+.5)*i.rowHeight-t.outerHeight(!0)/2;n._pushPosition(t,o,a),i.index++})},_cellsByColumnGetContainerSize:function(){return{width:Math.ceil(this.$filteredAtoms.length/this.cellsByColumn.rows)*this.cellsByColumn.columnWidth}},_cellsByColumnResizeChanged:function(){return this._checkIfSegmentsChanged(!0)},_straightAcrossReset:function(){this.straightAcross={x:0}},_straightAcrossLayout:function(t){var n=this;t.each(function(){var t=e(this);n._pushPosition(t,n.straightAcross.x,0),n.straightAcross.x+=t.outerWidth(!0)})},_straightAcrossGetContainerSize:function(){return{width:this.straightAcross.x}},_straightAcrossResizeChanged:function(){return!0}},e.fn.imagesLoaded=function(t){function n(){t.call(r,s)}function i(t){var r=t.target;r.src!==a&&-1===e.inArray(r,u)&&(u.push(r),--o<=0&&(setTimeout(n),s.unbind(".imagesLoaded",i)))}var r=this,s=r.find("img").add(r.filter("img")),o=s.length,a="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",u=[];return o||n(),s.bind("load.imagesLoaded error.imagesLoaded",i).each(function(){var t=this.src;this.src=a,this.src=t}),r};var C=function(e){t.console&&t.console.error(e)};e.fn.isotope=function(t,n){if("string"==typeof t){var i=Array.prototype.slice.call(arguments,1);this.each(function(){var n=e.data(this,"isotope");return n?e.isFunction(n[t])&&"_"!==t.charAt(0)?void n[t].apply(n,i):void C("no such method '"+t+"' for isotope instance"):void C("cannot call methods on isotope prior to initialization; attempted to call method '"+t+"'")})}else this.each(function(){var i=e.data(this,"isotope");i?(i.option(t),i._init(n)):e.data(this,"isotope",new e.Isotope(t,this,n))});return this}}(window,jQuery),n("isotope",function(){}),n("lib/isotope.patcheko",["jquery","isotope"],function(t){t.extend(t.Isotope.prototype,{debug:!1,_getFluidMasonryColumns:function(){if(!this.options.masonry||!this.options.masonry.minColWidth)throw"TODO: Exception, falsche Konfiguration!";this.masonry.gutterWidth=2*this.options.masonry.gutterWidth||0,this.containerWidth=this.element.width(),this._calculateCols(this.options.masonry.minColWidth,this.masonry.gutterWidth)},_calculateCols:function(t,e){this.debug&&console.log("Calculate the Params for the fluid masonry columns..."),t+=e;var n=Math.floor((this.containerWidth-e)/t);n=Math.max(n,1);var i,r=this.containerWidth-n*t;if(r>=0)i=t+Math.floor(r/n);else if(0>r)throw console.error(this),"Margin to big for "+n+" Columns";this.debug&&(console.log("Adding a restWidth of "+r+"px to the Columns"),console.log("Setting column configuration to "+n+" columns with a width of "+i+" px (minColWidth was "+this.options.masonry.minColWidth+"px).")),this.masonry.cols=n,this.masonry.columnWidth=i},_masonryLayout:function(e){var n=this,i=n.masonry,r=i.columnWidth-i.gutterWidth;e.each(function(){var e=t(this);e.width(r),n._masonryPlaceBrick(e,i.colYs)})},_masonryReset:function(){void 0!==this.masonry&&this.containerWidth&&this.containerWidth===this.element.width()||(this.masonry={},this._getFluidMasonryColumns());var t=this.masonry.cols;for(this.masonry.colYs=[];t--;)this.masonry.colYs.push(0)},_masonryResizeChanged:function(){var t=this.masonry.columnWidth;return this._getFluidMasonryColumns(),this.masonry.columnWidth!==t}})}),n("gallery/views/thumb.view",["jquery","backbone"],function(t,e){var n=e.View.extend({initialize:function(){this.model.setThumbView(this),this.gallery=this.options.gallery,this.template=this.options.template,this.responsiveAdapter=this.options.responsiveAdapter},events:{click:"openInSlider"},openInSlider:function(){this.gallery.trigger("thumb:clicked",this.model)},render:function(){var e=this.responsiveAdapter.presetMapperThumb(this.model),n=this.template({src:e.src,digest:this.model.get("digest")}).trim();return this.setElement(t.parseHTML(n)),this}});return n}),n("gallery/views/thumb.container.view",["jquery","jqueryui","vendor/jquery.throttle-debounce","underscore","backbone","lib/isotope.patcheko","gallery/views/thumb.view"],function(t,e,n,i,r,s,o){var a=r.View.extend({defaults:{itemSelector:".photo"},initialize:function(){this.options=i.extend({},this.defaults,this.options),this.responsiveAdapter=this.options.responsiveAdapter,this.listenToOnce(this.model,"change",this.initThumbs),t(window).on("resize.thumbContainer",i.bind(t.debounce(200,this.resize),this)),this.initMasonry()},initMasonry:function(){this.$el.isotope({itemSelector:this.options.itemSelector,resizable:!1,masonry:{minColWidth:this.responsiveAdapter.getMasonryMinColWidth(),gutterWidth:this.responsiveAdapter.getMasonryGutterWidth()}})},initThumbs:function(){var e=this.model,n=e.get("images");this.$(this.options.itemSelector).each(function(){var i=t(this),r=n.get(i.attr("id"));new o({model:r,el:i,gallery:e})}),this.arrangeThumbs(),this.$el.removeClass("loading"),this.$el.find(this.options.itemSelector).addClass("loaded",400)},arrangeThumbs:function(){this.$el.isotope()},resize:function(){this.debug&&console.log("Slider currently: "+this.model.sliderState);var t="closed"==this.model.sliderState?0:200,e=this;window.setTimeout(function(){e.arrangeThumbs()},t)},scrollToThumb:function(e){window.setTimeout(function(){if(e){var n=e.getThumbView();n&&t("html, body").animate({scrollTop:n.$el.offset().top},100)}},200)}});return a}),function(){function t(){}function e(t,e){for(var n=t.length;n--;)if(t[n].listener===e)return n;return-1}function i(t){return function(){return this[t].apply(this,arguments)}}var r=t.prototype,s=this,o=s.EventEmitter;r.getListeners=function(t){var e,n,i=this._getEvents();if(t instanceof RegExp){e={};for(n in i)i.hasOwnProperty(n)&&t.test(n)&&(e[n]=i[n])}else e=i[t]||(i[t]=[]);return e},r.flattenListeners=function(t){var e,n=[];for(e=0;e<t.length;e+=1)n.push(t[e].listener);return n},r.getListenersAsObject=function(t){var e,n=this.getListeners(t);return n instanceof Array&&(e={},e[t]=n),e||n},r.addListener=function(t,n){var i,r=this.getListenersAsObject(t),s="object"==typeof n;for(i in r)r.hasOwnProperty(i)&&-1===e(r[i],n)&&r[i].push(s?n:{listener:n,once:!1});return this},r.on=i("addListener"),r.addOnceListener=function(t,e){return this.addListener(t,{listener:e,once:!0})},r.once=i("addOnceListener"),r.defineEvent=function(t){return this.getListeners(t),this},r.defineEvents=function(t){for(var e=0;e<t.length;e+=1)this.defineEvent(t[e]);return this},r.removeListener=function(t,n){var i,r,s=this.getListenersAsObject(t);for(r in s)s.hasOwnProperty(r)&&(i=e(s[r],n),-1!==i&&s[r].splice(i,1));return this},r.off=i("removeListener"),r.addListeners=function(t,e){return this.manipulateListeners(!1,t,e)},r.removeListeners=function(t,e){return this.manipulateListeners(!0,t,e)},r.manipulateListeners=function(t,e,n){var i,r,s=t?this.removeListener:this.addListener,o=t?this.removeListeners:this.addListeners;if("object"!=typeof e||e instanceof RegExp)for(i=n.length;i--;)s.call(this,e,n[i]);else for(i in e)e.hasOwnProperty(i)&&(r=e[i])&&("function"==typeof r?s.call(this,i,r):o.call(this,i,r));return this},r.removeEvent=function(t){var e,n=typeof t,i=this._getEvents();if("string"===n)delete i[t];else if(t instanceof RegExp)for(e in i)i.hasOwnProperty(e)&&t.test(e)&&delete i[e];else delete this._events;return this},r.removeAllListeners=i("removeEvent"),r.emitEvent=function(t,e){var n,i,r,s,o=this.getListenersAsObject(t);for(r in o)if(o.hasOwnProperty(r))for(i=o[r].length;i--;)n=o[r][i],n.once===!0&&this.removeListener(t,n.listener),s=n.listener.apply(this,e||[]),s===this._getOnceReturnValue()&&this.removeListener(t,n.listener);return this},r.trigger=i("emitEvent"),r.emit=function(t){var e=Array.prototype.slice.call(arguments,1);return this.emitEvent(t,e)},r.setOnceReturnValue=function(t){return this._onceReturnValue=t,this},r._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},r._getEvents=function(){return this._events||(this._events={})},t.noConflict=function(){return s.EventEmitter=o,t},"function"==typeof n&&n.amd?n("eventEmitter/EventEmitter",[],function(){return t}):"object"==typeof module&&module.exports?module.exports=t:this.EventEmitter=t}.call(this),function(t){function e(e){var n=t.event;return n.target=n.target||n.srcElement||e,n}var i=document.documentElement,r=function(){};i.addEventListener?r=function(t,e,n){t.addEventListener(e,n,!1)}:i.attachEvent&&(r=function(t,n,i){t[n+i]=i.handleEvent?function(){var n=e(t);i.handleEvent.call(i,n)}:function(){var n=e(t);i.call(t,n)},t.attachEvent("on"+n,t[n+i])});var s=function(){};i.removeEventListener?s=function(t,e,n){t.removeEventListener(e,n,!1)}:i.detachEvent&&(s=function(t,e,n){t.detachEvent("on"+e,t[e+n]);try{delete t[e+n]}catch(i){t[e+n]=void 0}});var o={bind:r,unbind:s};"function"==typeof n&&n.amd?n("eventie/eventie",o):"object"==typeof exports?module.exports=o:t.eventie=o}(this),function(t,i){"function"==typeof n&&n.amd?n("imagesloaded",["eventEmitter/EventEmitter","eventie/eventie"],function(e,n){return i(t,e,n)}):"object"==typeof exports?module.exports=i(t,e("eventEmitter"),e("eventie")):t.imagesLoaded=i(t,t.EventEmitter,t.eventie)}(this,function(t,e,n){function i(t,e){for(var n in e)t[n]=e[n];return t}function r(t){return"[object Array]"===f.call(t)}function s(t){var e=[];if(r(t))e=t;else if("number"==typeof t.length)for(var n=0,i=t.length;i>n;n++)e.push(t[n]);else e.push(t);return e}function o(t,e,n){if(!(this instanceof o))return new o(t,e);"string"==typeof t&&(t=document.querySelectorAll(t)),this.elements=s(t),this.options=i({},this.options),"function"==typeof e?n=e:i(this.options,e),n&&this.on("always",n),this.getImages(),l&&(this.jqDeferred=new l.Deferred);var r=this;setTimeout(function(){r.check()})}function a(t){this.img=t}function u(t){this.src=t,d[t]=this}var l=t.jQuery,h=t.console,c="undefined"!=typeof h,f=Object.prototype.toString;o.prototype=new e,o.prototype.options={},o.prototype.getImages=function(){this.images=[];for(var t=0,e=this.elements.length;e>t;t++){var n=this.elements[t];"IMG"===n.nodeName&&this.addImage(n);for(var i=n.querySelectorAll("img"),r=0,s=i.length;s>r;r++){var o=i[r];this.addImage(o)}}},o.prototype.addImage=function(t){var e=new a(t);this.images.push(e)},o.prototype.check=function(){function t(t,r){return e.options.debug&&c&&h.log("confirm",t,r),e.progress(t),n++,n===i&&e.complete(),!0}var e=this,n=0,i=this.images.length;if(this.hasAnyBroken=!1,!i)return void this.complete();for(var r=0;i>r;r++){var s=this.images[r];s.on("confirm",t),s.check()}},o.prototype.progress=function(t){this.hasAnyBroken=this.hasAnyBroken||!t.isLoaded;var e=this;setTimeout(function(){e.emit("progress",e,t),e.jqDeferred&&e.jqDeferred.notify&&e.jqDeferred.notify(e,t)})},o.prototype.complete=function(){var t=this.hasAnyBroken?"fail":"done";this.isComplete=!0;var e=this;setTimeout(function(){if(e.emit(t,e),e.emit("always",e),e.jqDeferred){var n=e.hasAnyBroken?"reject":"resolve";e.jqDeferred[n](e)}})},l&&(l.fn.imagesLoaded=function(t,e){var n=new o(this,t,e);return n.jqDeferred.promise(l(this))}),a.prototype=new e,a.prototype.check=function(){var t=d[this.img.src]||new u(this.img.src);if(t.isConfirmed)return void this.confirm(t.isLoaded,"cached was confirmed");if(this.img.complete&&void 0!==this.img.naturalWidth)return void this.confirm(0!==this.img.naturalWidth,"naturalWidth");var e=this;t.on("confirm",function(t,n){return e.confirm(t.isLoaded,n),!0}),t.check()},a.prototype.confirm=function(t,e){this.isLoaded=t,this.emit("confirm",this,e)};var d={};return u.prototype=new e,u.prototype.check=function(){if(!this.isChecked){var t=new Image;n.bind(t,"load",this),n.bind(t,"error",this),t.src=this.src,this.isChecked=!0}},u.prototype.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},u.prototype.onload=function(t){this.confirm(!0,"onload"),this.unbindProxyEvents(t)},u.prototype.onerror=function(t){this.confirm(!1,"onerror"),this.unbindProxyEvents(t)},u.prototype.confirm=function(t,e){this.isConfirmed=!0,this.isLoaded=t,this.emit("confirm",this,e)},u.prototype.unbindProxyEvents=function(t){n.unbind(t.target,"load",this),n.unbind(t.target,"error",this)},o}),n("lib/jquery.inview",["jquery","vendor/jquery.throttle-debounce"],function(t){function e(){var e,n,i={height:c.innerHeight,width:c.innerWidth};return i.height||(e=h.compatMode,(e||!t.support.boxModel)&&(n="CSS1Compat"===e?f:h.body,i={height:n.clientHeight,width:n.clientWidth})),i}function n(){return{top:c.pageYOffset||f.scrollTop||h.body.scrollTop,left:c.pageXOffset||f.scrollLeft||h.body.scrollLeft}}function i(){var i,r=t(),s=0;if(t.each(l,function(t,e){var n=e.data.selector,i=e.$element;i=n?i.find(n):i,i.data("inview_opts",e.data.data),r=r.add(i)}),i=r.length,u&&(console.log("inviewObjects: "),console.log(l),console.log("elementsLength: "+i)),i)for(o=o||e(),a=a||n(),u&&(console.log("viewportSize: "),console.log(o),console.log("viewportOffset: "),console.log(a));i>s;s++)if(t.contains(f,r[s])){var h,c,d,p=t(r[s]),g={height:p.height(),width:p.width()},m=p.offset(),v=p.data("inview"),y=p.data("inview_opts").threshold;if(y){this.debug&&console.log("Threshold: "+y);var w=m.top,b=m.left;m={top:w-y,left:b-y}}if(u&&(console.log("elementSize: "),console.log(g),console.log("elementOffset: "),console.log(m)),!a||!o)return;m.top<a.top+o.height&&m.left<a.left+o.width?(h=a.left>m.left?"right":a.left+o.width<m.left+g.width?"left":"both",c=a.top>m.top?"bottom":a.top+o.height<m.top+g.height?"top":"both",d=h+"-"+c,p.data("inview",d).trigger("inview",[!0,h,c])):v&&p.data("inview",!1).trigger("inview",[!1])}}function r(){t(c).bind("scroll.inview resize.inview",t.throttle(250,function(){u&&console.log("Hello inview.js checks it out!"),o=a=null,i()}))}function s(){t(c).unbind("scroll.inview resize.inview")}var o,a,u=!1,l={},h=document,c=window,f=h.documentElement,d=t.expando;t.event.special.inview={add:function(e){l[e.guid+"-"+this[d]]={data:e,$element:t(this)},r()},remove:function(t){s();try{delete l[t.guid+"-"+this[d]]}catch(e){}}}}),n("gallery/views/thumb.container.dynamic.view",["jquery","imagesloaded","lib/jquery.inview","underscore","backbone","gallery/views/thumb.container.view","gallery/views/thumb.view"],function(t,e,n,i,r,s,o){var a=s.extend({debug:!1,initialize:function(){this.thumbTemplate=this.getThumbTemplate(),this.loadedImages=0,this.imagesToLoad,this.firstChunk=this.options.gallery_opts.first_chunk,this.chunkSize=this.options.gallery_opts.chunk_size,this.threshold=300,this.constructor.__super__.initialize.apply(this,arguments),this.stopper=this.$el.next(".stopper"),this.listenTo(this.model,"slider:newImage",this.onNewSliderImage),this.listenTo(this.model,"slider:closing",this.onSliderClosing)},initThumbs:function(){this.imagesToLoad=this.model.get("images").models.slice();var t=this._renderChunk(this.firstChunk);this.$el.removeClass("loading"),this._checkImagesLoaded(t)},renderNextChunk:function(){this.timeout_bind=window.setTimeout(i.bind(this._bindInview,this),2e3),this._unbindInview();var t=this._renderChunk(this.chunkSize);this._checkImagesLoaded(t)},_bindInview:function(){window.clearTimeout(this.timeout_bind),this.imagesToLoad.length&&!this._listening_for_inview?(this.stopper.show(),this.stopper.on("inview",{threshold:this.threshold},i.bind(this._onStopperAppeared,this)),this._listening_for_inview=!0,t(window).trigger("scroll")):this.stopper.hide()},_unbindInview:function(){this.stopper.off("inview"),this._listening_for_inview=!1},_onStopperAppeared:function(t,e){e?(this.debug&&console.log("SToPPer gesichtet!"),this.renderNextChunk()):this.debug&&console.log("STopper out of sight!")},_renderChunk:function(t){for(var e=new Array,n=0;t>n&&(imageModel=this.imagesToLoad.shift(),imageModel);n++){var i=new o({model:imageModel,gallery:this.model,template:this.thumbTemplate,responsiveAdapter:this.responsiveAdapter});i=i.render(),this.$el.append(i.$el),this.$el.isotope("appended",i.$el),e.push(i.el)}return e},_checkImagesLoaded:function(n){var r=this;e(n).on("progress",function(t,e){if(e.isLoaded){{r.switchThumbClass(e.img)}r.arrangeThumbs()}}).on("always",function(){r.debug&&(console.log("last stopperAppeared trigger completed."),console.log("left over imagesToLoad: "+r.imagesToLoad.length)),window.setTimeout(i.bind(r.arrangeThumbs,r),200),r._bindInview()}).on("fail",function(t){t.debug&&console.log("FAIL - all images loaded, at least one is broken")}),t(n).each(function(e,n){if(t(n).prop("complete")){{r.switchThumbClass(n.img)}r.arrangeThumbs()}})},switchThumbClass:function(e){var n=t(e).parent();return n.switchClass("loading","loaded")},onNewSliderImage:function(t){i.contains(this.imagesToLoad,t.model)&&window.setTimeout(i.bind(function(){this.renderNextChunk()},this),200)},onSliderClosing:function(t){t&&this.scrollToThumb(t.model)},getThumbTemplate:function(){return i.template(t("#template-thumb").html())}});return a}),function(t){function e(e){return!e||void 0!==e.allowPageScroll||void 0===e.swipe&&void 0===e.swipeStatus||(e.allowPageScroll=l),void 0!==e.click&&void 0===e.tap&&(e.tap=e.click),e||(e={}),e=t.extend({},t.fn.swipe.defaults,e),this.each(function(){var i=t(this),r=i.data(S);r||(r=new n(this,e),i.data(S,r))})}function n(e,n){function k(e){if(!(ae()||t(e.target).closest(n.excludedElements,Be).length>0)){var i,r=e.originalEvent?e.originalEvent:e,s=T?r.touches[0]:r;return We=b,T?Fe=r.touches.length:e.preventDefault(),ze=0,Ie=null,Ne=null,$e=0,Pe=0,Re=0,He=1,De=0,Ue=fe(),qe=ge(),se(),!T||Fe===n.fingers||n.fingers===y||q()?(le(0,s),Qe=Te(),2==Fe&&(le(1,r.touches[1]),Pe=Re=ye(Ue[0].start,Ue[1].start)),(n.swipeStatus||n.pinchStatus)&&(i=z(r,We))):i=!1,i===!1?(We=C,z(r,We),i):void ue(!0)}}function A(t){var e=t.originalEvent?t.originalEvent:t;if(We!==x&&We!==C&&!oe()){var i,r=T?e.touches[0]:e,s=he(r);if(Ve=Te(),T&&(Fe=e.touches.length),We=_,2==Fe&&(0==Pe?(le(1,e.touches[1]),Pe=Re=ye(Ue[0].start,Ue[1].start)):(he(e.touches[1]),Re=ye(Ue[0].end,Ue[1].end),Ne=be(Ue[0].end,Ue[1].end)),He=we(Pe,Re),De=Math.abs(Pe-Re)),Fe===n.fingers||n.fingers===y||!T||q()){if(Ie=Ce(s.start,s.end),D(t,Ie),ze=_e(s.start,s.end),$e=ve(),de(Ie,ze),(n.swipeStatus||n.pinchStatus)&&(i=z(e,We)),!n.triggerOnTouchEnd||n.triggerOnTouchLeave){var o=!0;if(n.triggerOnTouchLeave){var a=Se(this);o=ke(s.end,a)}!n.triggerOnTouchEnd&&o?We=L(_):n.triggerOnTouchLeave&&!o&&(We=L(x)),(We==C||We==x)&&z(e,We)}}else We=C,z(e,We);i===!1&&(We=C,z(e,We))}}function E(t){var e=t.originalEvent;return T&&e.touches.length>0?(re(),!0):(oe()&&(Fe=Xe),t.preventDefault(),Ve=Te(),$e=ve(),P()?(We=C,z(e,We)):n.triggerOnTouchEnd||0==n.triggerOnTouchEnd&&We===_?(We=x,z(e,We)):!n.triggerOnTouchEnd&&G()?(We=x,I(e,We,d)):We===_&&(We=C,z(e,We)),void ue(!1))}function M(){Fe=0,Ve=0,Qe=0,Pe=0,Re=0,He=1,se(),ue(!1)}function j(t){var e=t.originalEvent;n.triggerOnTouchLeave&&(We=L(x),z(e,We))}function O(){Be.unbind(Ee,k),Be.unbind(Le,M),Be.unbind(Me,A),Be.unbind(je,E),Oe&&Be.unbind(Oe,j),ue(!1)}function L(t){var e=t,i=H(),r=$(),s=P();return!i||s?e=C:!r||t!=_||n.triggerOnTouchEnd&&!n.triggerOnTouchLeave?!r&&t==x&&n.triggerOnTouchLeave&&(e=C):e=x,e}function z(t,e){var n=void 0;return U()||F()?n=I(t,e,c):(B()||q())&&n!==!1&&(n=I(t,e,f)),ne()&&n!==!1?n=I(t,e,p):ie()&&n!==!1?n=I(t,e,g):ee()&&n!==!1&&(n=I(t,e,d)),e===C&&M(t),e===x&&(T?0==t.touches.length&&M(t):M(t)),n}function I(e,l,h){var m=void 0;if(h==c){if(Be.trigger("swipeStatus",[l,Ie||null,ze||0,$e||0,Fe]),n.swipeStatus&&(m=n.swipeStatus.call(Be,e,l,Ie||null,ze||0,$e||0,Fe),m===!1))return!1;if(l==x&&W()){if(Be.trigger("swipe",[Ie,ze,$e,Fe]),n.swipe&&(m=n.swipe.call(Be,e,Ie,ze,$e,Fe),m===!1))return!1;switch(Ie){case i:Be.trigger("swipeLeft",[Ie,ze,$e,Fe]),n.swipeLeft&&(m=n.swipeLeft.call(Be,e,Ie,ze,$e,Fe));break;case r:Be.trigger("swipeRight",[Ie,ze,$e,Fe]),n.swipeRight&&(m=n.swipeRight.call(Be,e,Ie,ze,$e,Fe));break;case s:Be.trigger("swipeUp",[Ie,ze,$e,Fe]),n.swipeUp&&(m=n.swipeUp.call(Be,e,Ie,ze,$e,Fe));break;case o:Be.trigger("swipeDown",[Ie,ze,$e,Fe]),n.swipeDown&&(m=n.swipeDown.call(Be,e,Ie,ze,$e,Fe))}}}if(h==f){if(Be.trigger("pinchStatus",[l,Ne||null,De||0,$e||0,Fe,He]),n.pinchStatus&&(m=n.pinchStatus.call(Be,e,l,Ne||null,De||0,$e||0,Fe,He),m===!1))return!1;if(l==x&&N())switch(Ne){case a:Be.trigger("pinchIn",[Ne||null,De||0,$e||0,Fe,He]),n.pinchIn&&(m=n.pinchIn.call(Be,e,Ne||null,De||0,$e||0,Fe,He));break;case u:Be.trigger("pinchOut",[Ne||null,De||0,$e||0,Fe,He]),n.pinchOut&&(m=n.pinchOut.call(Be,e,Ne||null,De||0,$e||0,Fe,He))}}return h==d?(l===C||l===x)&&(clearTimeout(Ye),X()&&!Z()?(Je=Te(),Ye=setTimeout(t.proxy(function(){Je=null,Be.trigger("tap",[e.target]),n.tap&&(m=n.tap.call(Be,e,e.target))},this),n.doubleTapThreshold)):(Je=null,Be.trigger("tap",[e.target]),n.tap&&(m=n.tap.call(Be,e,e.target)))):h==p?(l===C||l===x)&&(clearTimeout(Ye),Je=null,Be.trigger("doubletap",[e.target]),n.doubleTap&&(m=n.doubleTap.call(Be,e,e.target))):h==g&&(l===C||l===x)&&(clearTimeout(Ye),Je=null,Be.trigger("longtap",[e.target]),n.longTap&&(m=n.longTap.call(Be,e,e.target))),m}function $(){var t=!0;return null!==n.threshold&&(t=ze>=n.threshold),t}function P(){var t=!1;return null!==n.cancelThreshold&&null!==Ie&&(t=pe(Ie)-ze>=n.cancelThreshold),t}function R(){return null!==n.pinchThreshold?De>=n.pinchThreshold:!0}function H(){var t;return t=n.maxTimeThreshold?$e>=n.maxTimeThreshold?!1:!0:!0}function D(t,e){if(n.allowPageScroll===l||q())t.preventDefault();else{var a=n.allowPageScroll===h;switch(e){case i:(n.swipeLeft&&a||!a&&n.allowPageScroll!=m)&&t.preventDefault();break;case r:(n.swipeRight&&a||!a&&n.allowPageScroll!=m)&&t.preventDefault();break;case s:(n.swipeUp&&a||!a&&n.allowPageScroll!=v)&&t.preventDefault();break;case o:(n.swipeDown&&a||!a&&n.allowPageScroll!=v)&&t.preventDefault()}}}function N(){var t=Q(),e=V(),n=R();return t&&e&&n}function q(){return!!(n.pinchStatus||n.pinchIn||n.pinchOut)}function B(){return!(!N()||!q())}function W(){var t=H(),e=$(),n=Q(),i=V(),r=P(),s=!r&&i&&n&&e&&t;return s}function F(){return!!(n.swipe||n.swipeStatus||n.swipeLeft||n.swipeRight||n.swipeUp||n.swipeDown)}function U(){return!(!W()||!F())}function Q(){return Fe===n.fingers||n.fingers===y||!T}function V(){return 0!==Ue[0].end.x}function G(){return!!n.tap}function X(){return!!n.doubleTap}function J(){return!!n.longTap}function Y(){if(null==Je)return!1;var t=Te();return X()&&t-Je<=n.doubleTapThreshold}function Z(){return Y()}function K(){return!(1!==Fe&&T||!isNaN(ze)&&0!==ze)}function te(){return $e>n.longTapThreshold&&w>ze}function ee(){return!(!K()||!G())}function ne(){return!(!Y()||!X())}function ie(){return!(!te()||!J())}function re(){Ge=Te(),Xe=event.touches.length+1}function se(){Ge=0,Xe=0}function oe(){var t=!1;if(Ge){var e=Te()-Ge;e<=n.fingerReleaseThreshold&&(t=!0)}return t}function ae(){return!(Be.data(S+"_intouch")!==!0)}function ue(t){t===!0?(Be.bind(Me,A),Be.bind(je,E),Oe&&Be.bind(Oe,j)):(Be.unbind(Me,A,!1),Be.unbind(je,E,!1),Oe&&Be.unbind(Oe,j,!1)),Be.data(S+"_intouch",t===!0)}function le(t,e){var n=void 0!==e.identifier?e.identifier:0;return Ue[t].identifier=n,Ue[t].start.x=Ue[t].end.x=e.pageX||e.clientX,Ue[t].start.y=Ue[t].end.y=e.pageY||e.clientY,Ue[t]}function he(t){var e=void 0!==t.identifier?t.identifier:0,n=ce(e);return n.end.x=t.pageX||t.clientX,n.end.y=t.pageY||t.clientY,n}function ce(t){for(var e=0;e<Ue.length;e++)if(Ue[e].identifier==t)return Ue[e]}function fe(){for(var t=[],e=0;5>=e;e++)t.push({start:{x:0,y:0},end:{x:0,y:0},identifier:0});return t}function de(t,e){e=Math.max(e,pe(t)),qe[t].distance=e}function pe(t){return qe[t].distance}function ge(){var t={};return t[i]=me(i),t[r]=me(r),t[s]=me(s),t[o]=me(o),t}function me(t){return{direction:t,distance:0}}function ve(){return Ve-Qe}function ye(t,e){var n=Math.abs(t.x-e.x),i=Math.abs(t.y-e.y);return Math.round(Math.sqrt(n*n+i*i))}function we(t,e){var n=e/t*1;return n.toFixed(2)}function be(){return 1>He?u:a}function _e(t,e){return Math.round(Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)))}function xe(t,e){var n=t.x-e.x,i=e.y-t.y,r=Math.atan2(i,n),s=Math.round(180*r/Math.PI);return 0>s&&(s=360-Math.abs(s)),s}function Ce(t,e){var n=xe(t,e);return 45>=n&&n>=0?i:360>=n&&n>=315?i:n>=135&&225>=n?r:n>45&&135>n?o:s}function Te(){var t=new Date;return t.getTime()}function Se(e){e=t(e);var n=e.offset(),i={left:n.left,right:n.left+e.outerWidth(),top:n.top,bottom:n.top+e.outerHeight()};return i}function ke(t,e){return t.x>e.left&&t.x<e.right&&t.y>e.top&&t.y<e.bottom}var Ae=T||!n.fallbackToMouseEvents,Ee=Ae?"touchstart":"mousedown",Me=Ae?"touchmove":"mousemove",je=Ae?"touchend":"mouseup",Oe=Ae?null:"mouseleave",Le="touchcancel",ze=0,Ie=null,$e=0,Pe=0,Re=0,He=1,De=0,Ne=0,qe=null,Be=t(e),We="start",Fe=0,Ue=null,Qe=0,Ve=0,Ge=0,Xe=0,Je=0,Ye=null;try{Be.bind(Ee,k),Be.bind(Le,M)}catch(Ze){t.error("events not supported "+Ee+","+Le+" on jQuery.swipe")}this.enable=function(){return Be.bind(Ee,k),Be.bind(Le,M),Be},this.disable=function(){return O(),Be},this.destroy=function(){return O(),Be.data(S,null),Be},this.option=function(e,i){if(void 0!==n[e]){if(void 0===i)return n[e];n[e]=i}else t.error("Option "+e+" does not exist on jQuery.swipe.options")}}var i="left",r="right",s="up",o="down",a="in",u="out",l="none",h="auto",c="swipe",f="pinch",d="tap",p="doubletap",g="longtap",m="horizontal",v="vertical",y="all",w=10,b="start",_="move",x="end",C="cancel",T="ontouchstart"in window,S="TouchSwipe",k={fingers:1,threshold:75,cancelThreshold:null,pinchThreshold:20,maxTimeThreshold:null,fingerReleaseThreshold:250,longTapThreshold:500,doubleTapThreshold:200,swipe:null,swipeLeft:null,swipeRight:null,swipeUp:null,swipeDown:null,swipeStatus:null,pinchIn:null,pinchOut:null,pinchStatus:null,click:null,tap:null,doubleTap:null,longTap:null,triggerOnTouchEnd:!0,triggerOnTouchLeave:!1,allowPageScroll:"auto",fallbackToMouseEvents:!0,excludedElements:"button, input, select, textarea, a, .noSwipe"};t.fn.swipe=function(n){var i=t(this),r=i.data(S);if(r&&"string"==typeof n){if(r[n])return r[n].apply(this,Array.prototype.slice.call(arguments,1));t.error("Method "+n+" does not exist on jQuery.swipe")}else if(!(r||"object"!=typeof n&&n))return e.apply(this,arguments);return i},t.fn.swipe.defaults=k,t.fn.swipe.phases={PHASE_START:b,PHASE_MOVE:_,PHASE_END:x,PHASE_CANCEL:C},t.fn.swipe.directions={LEFT:i,RIGHT:r,UP:s,DOWN:o,IN:a,OUT:u},t.fn.swipe.pageScroll={NONE:l,HORIZONTAL:m,VERTICAL:v,AUTO:h},t.fn.swipe.fingers={ONE:1,TWO:2,THREE:3,ALL:y}}(jQuery),n("vendor/jquery.touchSwipe",function(){}),n("gallery/views/large.view",["jquery","underscore","backbone"],function(t,e,n){var i=n.View.extend({debug:!1,initialize:function(){this.slider=this.options.slider,this.responsiveAdapter=this.slider.responsiveAdapter,this.currentSliderRatio=void 0,this.curDims={},this.largeAttrs=this.responsiveAdapter.presetMapperLarge(this.model),this.setElement(t("<img/>")),this.$el.attr("src",this.largeAttrs.src).css({"max-width":this.largeAttrs.width,"max-height":this.largeAttrs.height}),this.model.setLargeView(this)},events:{load:"loaded"},resize:function(){if(this.currentSliderRatio!=this.slider.ratio){this.currentSliderRatio=this.slider.ratio,this.curDims=this._calculateDims();var t=this;window.setTimeout(function(){t.$el.animate({width:t.curDims.px[0],height:t.curDims.px[1]},0)},0)}},getWidth:function(){return this.curDims.px[0]},getHeight:function(){return this.curDims.px[1]},_calculateDims:function(){var t=this.model.get("orientation");return"landscape"==t?(this._setLargeToFullWith(),this.curDims.px[1]>this.slider.height&&(this.debug&&console.log("ups, image to high for slider, when set to full slider width!"),this._setLargeToFullHeight())):"portrait"==t&&(this._setLargeToFullHeight(),this.curDims.px[0]>this.slider.width&&(this.debug&&console.log("ups, image to wide for slider, when set to full slider height!"),this._setLargeToFullWith())),this.curDims},_setLargeToFullWith:function(){this.curDims.percent=["100%",""],this.curDims.px=[Math.min(this.slider.width,this.largeAttrs.width),Math.min(Math.floor(this.slider.width/this.model.get("ratio")),this.largeAttrs.height)],this.debug&&console.log("100% width =>"+this.slider.width+"x"+this.curDims.px[1]+"px; Container: "+this.slider.width+"x"+this.slider.height+"px.")},_setLargeToFullHeight:function(){this.curDims.percent=["","100%"],this.curDims.px=[Math.min(Math.floor(this.slider.height*this.model.get("ratio")),this.largeAttrs.width),Math.min(this.slider.height,this.largeAttrs.height)],this.debug&&console.log("100% height =>"+this.curDims.px[0]+"x"+this.curDims.px[1]+"px; container: "+this.slider.width+"x"+this.slider.height+"px.")},loaded:function(){this.debug&&console.log("LargeView for Image "+this.model.id+" is loaded")}});return i}),n("gallery/views/cockpit.view",["jquery","vendor/jquery.touchSwipe","underscore","backbone"],function(t,e,n,i){var r=i.View.extend({el:".cockpit",initialize:function(){this.$el.length&&(this.isActive()?(this.button=this.$(".cockpit_button"),this.body=this.$(".cockpit_body").addClass("hidden"),this.slider=this.options.slider,this.listenTo(this.model,"slider:newImage",this.updateImage),this.button.swipe({tap:n.bind(this.toggleBody,this)})):this.$el.hide())},remove:function(){this.button.swipe("destroy"),i.View.prototype.remove.call(this)},isActive:function(){return this.options.cockpit},toggleBody:function(){this.body.toggleClass("hidden")},updateImage:function(t){var e=t.model;this.body.find(".index").html(e.index()+1+" / "+this.model.get("images").length),this.body.find(".filename").html(e.get("filename"))}});return r}),n("gallery/views/slider.view",["jquery","jqueryui","vendor/jquery.touchSwipe","vendor/jquery.throttle-debounce","underscore","backbone","gallery/views/large.view","gallery/views/cockpit.view"],function(t,e,n,i,r,s,o,a){var u=s.View.extend({defaults:{cockpit:!0},events:{"click .nav.prev":"showPrev","click .nav.next":"showNext"},initialize:function(){this.options=r.extend({},this.defaults,this.options),t("body").addClass("slider_closed"),this.tray=this.$(".tray"),this.current_box=this.$(".photo.current"),this.prev_box=this.$(".photo.prev"),this.next_box=this.$(".photo.next"),this.nav_prev=this.$(".nav.prev"),this.nav_next=this.$(".nav.next"),this.current=void 0,this.responsiveAdapter=this.options.responsiveAdapter,this.listenTo(this.model,"thumb:clicked",this.openSlider),t(window).on("resize.slider",r.bind(t.debounce(200,this.resize),this)),t(window).on("keyup.slider",r.bind(this.keys,this)),this.touchable="ontouchstart"in window,this.touchable||this.tray.on("mousemove.slider",r.bind(t.throttle(150,this.mousemove),this)),this.cockpit=new a({model:this.model,cockpit:this.options.cockpit,slider:this}),this.initSwipeHandler(),this.$el.swipe("disable"),this.listenToOnce(this.model,"sync",function(){if(window.location.hash.length>2){var t=this.model.get("images").get(window.location.hash.substr(2));t&&(this.openSlider(t),window.setTimeout(r.bind(this.resize,this),250))}})},initSwipeHandler:function(){var t=this;this.$el.swipe({swipeLeft:function(e){t.showNext(),e.preventDefault()},swipeRight:function(e){t.showPrev(),e.preventDefault()},tap:function(e){e.preventDefault(),t.click(e)},allowPageScroll:"none"})},remove:function(){t(window).off("resize.slider"),t(window).off("keyup.slider"),this.touchable&&this.tray.off("mousemove.slider"),this.$el.swipe("destroy"),s.View.prototype.remove.call(this)},keys:function(t){if(this.isOpen())switch(t.keyCode){case 27:this.closeSlider();break;case 39:this.showNext();break;case 37:this.showPrev()}},click:function(t){var e=this._mapMouseEvent(t);switch(e){case"nav.prev":this.showPrev();break;case"nav.next":this.showNext();break;case"ESC":this.closeSlider()}},mousemove:function(t){var e=this._mapMouseEvent(t);"nav.prev"==e?(this.nav_next.removeClass("active"),this.nav_prev.addClass("active")):"nav.next"==e?(this.nav_prev.removeClass("active"),this.nav_next.addClass("active")):(this.nav_prev.removeClass("active"),this.nav_next.removeClass("active"))},_mapMouseEvent:function(e){var n=t(e.target);if(n.is(".photo img")){var i=e.changedTouches&&e.changedTouches.length?e.changedTouches[0].pageX:e.pageX,r=i-t(e.target).offset().left,s=r/this.current.getWidth();
return.45>s?"nav.prev":"nav.next"}return 0==n.closest(".cockpit").length?"ESC":void 0},isOpen:function(){return this.$el.hasClass("open")},openSlider:function(e){this._setDimensions(),this._setCurrent(e),this.$el.addClass("open"),t("body").removeClass("slider_closed"),this.$el.addClass("visible",800),this.$el.swipe("enable"),this.model.toggleSliderState()},showNext:function(){if(this.next){var t=this.$el.find("#prev");this.prev=this.current,this.prev_box=this.current_box.attr("id","prev"),this.current=this.next,this.model.setCurrent(this.next.model),this.current_box=this.next_box.attr("id","current"),this.next_box=t.attr("id","next"),this.prev_box.switchClass("current","prev",{duration:300,queue:!0,easing:"linear"}),this.current_box.switchClass("next","current",{duration:300,queue:!0,easing:"linear"}),this.next_box.switchClass("prev","next",{duration:0,queue:!0}),this._setNext(),this._currentChanged()}},showPrev:function(){if(this.prev){var t=this.$el.find("#next");this.next=this.current,this.next_box=this.current_box.attr("id","next"),this.current=this.prev,this.model.setCurrent(this.prev.model),this.current_box=this.prev_box.attr("id","current"),this.prev_box=t.attr("id","prev"),this.next_box.switchClass("current","next",{duration:300,queue:!0,easing:"linear"}),this.current_box.switchClass("prev","current",{duration:300,queue:!0,easing:"linear"}),this.prev_box.switchClass("next","prev"),this._setPrev(),this._currentChanged()}},closeSlider:function(){this.model.trigger("slider:closing",this.current),this.$el.removeClass("open visible",800),t("body").addClass("slider_closed"),this._setCurrent(void 0),this.current=this.next=this.perv=void 0,this.$(".photo").empty(),this._setHashbang("","MPTI"),this.$el.swipe("disable"),this.model.toggleSliderState()},_setHashbang:function(t,e){if(Modernizr.history){var n=document.location.href;n=n.replace(/\#.*/,"")+"#!"+t,history.replaceState(null,e,n)}},_currentChanged:function(){this._setHashbang(this.current.model.id,"Image "+this.current.model.id),this.model.trigger("slider:newImage",this.current),this.next?this.nav_next.removeClass("visuallyhidden"):this.nav_next.addClass("visuallyhidden"),this.prev?this.nav_prev.removeClass("visuallyhidden"):this.nav_prev.addClass("visuallyhidden")},_setCurrent:function(t){this.model.setCurrent(t);var e=this._loadOrGetLarge(t);e&&(this.current=e,this.current_box.html(this.current.$el),this._currentChanged(),this._setNext(),this._setPrev())},_setNext:function(){this.model.get("images");return this.next=this._loadOrGetLarge(this.model.getNext()),this.next?(this.next_box.html(this.next.$el),this.nav_next.removeClass("visuallyhidden")):this.nav_next.addClass("visuallyhidden"),this.next},_setPrev:function(){this.model.get("images");return this.prev=this._loadOrGetLarge(this.model.getPrev()),this.prev?(this.prev_box.html(this.prev.$el),this.nav_prev.removeClass("visuallyhidden")):this.nav_prev.addClass("visuallyhidden"),this.prev},_loadOrGetLarge:function(t){if(t){var e=t.getLargeView()||new o({model:t,slider:this});return e.resize(),e}return void 0},resize:function(){this._setDimensions(),this.current&&this.current.resize(),this.next&&this.next.resize(),this.prev&&this.prev.resize()},_setDimensions:function(){this.width=this.tray.width(),this.height=this.tray.height(),this.ratio=this.width/this.height,this.orientation=this.ratio>1?"landscape":"portrait"}});return u}),n("gallery/utils/responsive.adapter",["jquery","underscore"],function(t,e){var n=function(t){this.mediaType=this.setMediaType(),this.opts=t};return e.extend(n.prototype,{setMediaType:function(){if(!window.getComputedStyle)return this.mediaType="desktop";var t=window.getComputedStyle(document.body,":after").getPropertyValue("content").match(/[a-zA-Z_\-0-9]+/g);return console.log(t),this.mediaType=t&&t.length>0?t[0]:"desktop"},getMediaType:function(){return this.mediaType},getMasonryMinColWidth:function(){return t.isPlainObject(this.opts.min_col_width)?this.opts.min_col_width[this.mediaType]:this.opts.min_col_width},getMasonryGutterWidth:function(){return t.isPlainObject(this.opts.gutter_width)?this.opts.gutter_width[this.mediaType]:this.opts.gutter_width},presetMapperThumb:function(t){var e;switch(this.mediaType){case"desktop":case"pad":case"phone":e=t.get("thumb")}return e},presetMapperLarge:function(t){var e;switch(this.mediaType){case"desktop":e=t.get("large");break;case"pad":e=t.get("large_pads");break;case"phone":e=t.get("large_phones")}return e}}),n}),n("gallery/app",["backbone","underscore","gallery/models/gallery.model","gallery/views/thumb.container.view","gallery/views/thumb.container.dynamic.view","gallery/views/slider.view","gallery/utils/responsive.adapter"],function(t,e,n,i,r,s,o){var a=t.View.extend({el:"article.gallery",defaults:{min_col_width:{desktop:320,pad:320,phone:300},gutter_width:3,chunk_size:8,first_chunk:15},initialize:function(){if(this.$el.length){this.opts=e.extend({},this.defaults,this.$el.data("opts")),this.model=new n({project:this.$el.data("project")}),this.responsiveAdapter=new o(this.opts);var t=this.$el.find(".container.photos"),a={model:this.model,el:t,itemSelector:".photo",responsiveAdapter:this.responsiveAdapter,gallery_opts:this.opts};this.containerView=t.find(".photo").length?new i(a):new r(a),this.model.fetch(),this.sliderView=new s({el:this.$(".slider"),model:this.model,responsiveAdapter:this.responsiveAdapter})}}});return a}),n("jquery",[],function(){return jQuery}),e("gallery/app")});